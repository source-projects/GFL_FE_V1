(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"CZC+":function(e,t,i){"use strict";i.r(t),i.d(t,"PaymentReportModule",(function(){return K}));var c=i("ofXK"),o=i("yzeJ"),r=i("tyNb"),a=i("rj63"),s=i("mrSG"),n=i("tcrU"),d=i("LvDl"),l=i("wd/R"),p=i("XNiG"),h=i("1G5W"),u=i("v1rY"),m=i("8tQ5"),y=i("bidh"),b=i("cmeu"),j=i("tA+f"),g=i("8k+d"),v=i("RNo3"),f=i("IYph"),R=i("fXoL"),q=i("5eHb"),P=i("aceb"),M=i("3Pt+"),F=i("ZOsW"),S=i("z17N");function H(e,t){if(1&e&&(R.jc(0,"ng-option",34),R.jd(1),R.ic()),2&e){const e=t.$implicit;R.Hc("value",e),R.Pb(1),R.ld("",e.name," ")}}function N(e,t){1&e&&(R.jc(0,"div",35),R.jc(1,"span"),R.jd(2,"From date is required."),R.ic(),R.ic())}function D(e,t){1&e&&(R.jc(0,"div",35),R.jc(1,"span"),R.jd(2,"To date is required."),R.ic(),R.ic())}function w(e,t){if(1&e&&(R.jc(0,"ng-option",34),R.jc(1,"div",1),R.jc(2,"div",22),R.jc(3,"div",23),R.jd(4),R.ic(),R.ic(),R.jc(5,"div",22),R.jc(6,"div",24),R.jd(7),R.ic(),R.ic(),R.ic(),R.ic()),2&e){const e=t.$implicit;R.Hc("value",e.id),R.Pb(4),R.ld(" ",e.partyName," "),R.Pb(3),R.ld(" ",e.partyCode," ")}}function I(e,t){if(1&e&&(R.jc(0,"ng-option",34),R.jc(1,"div",1),R.jc(2,"div",22),R.jc(3,"div",23),R.jd(4),R.ic(),R.ic(),R.jc(5,"div",22),R.jc(6,"div",24),R.jd(7),R.ic(),R.ic(),R.ic(),R.ic()),2&e){const e=t.$implicit;R.Hc("value",e.qualityEntryId),R.Pb(4),R.ld(" ",e.qualityId," "),R.Pb(3),R.ld(" ",e.partyName," ")}}function L(e,t){if(1&e&&(R.jc(0,"ng-option",34),R.jd(1),R.ic()),2&e){const e=t.$implicit;R.Hc("value",e.id),R.Pb(1),R.kd(e.userName)}}function O(e,t){if(1&e&&(R.jc(0,"ng-option",34),R.jc(1,"div",1),R.jc(2,"div",22),R.jc(3,"div",23),R.jd(4),R.ic(),R.ic(),R.ic(),R.ic()),2&e){const e=t.$implicit;R.Hc("value",e.id),R.Pb(4),R.ld(" ",e.qualityName,"")}}function x(e,t){if(1&e&&(R.jc(0,"th"),R.jd(1),R.ic()),2&e){const e=t.$implicit;R.Pb(1),R.kd(e)}}function T(e,t){if(1&e&&(R.jc(0,"th"),R.jd(1),R.ic()),2&e){const e=t.$implicit;R.Pb(1),R.kd(e)}}function $(e,t){if(1&e&&(R.jc(0,"td"),R.jd(1),R.ic()),2&e){const e=t.$implicit,i=R.yc().$implicit;R.Pb(1),R.kd(i[e])}}function C(e,t){if(1&e&&(R.jc(0,"tr"),R.hd(1,$,2,1,"td",46),R.ic()),2&e){const e=t.index,i=R.yc(4);R.ed("background",e%2==0?"#ffffff":"#f2f2f2"),R.Pb(1),R.Hc("ngForOf",i.headerArray)}}function k(e,t){if(1&e&&(R.jc(0,"div",41),R.jc(1,"div",42),R.jc(2,"div",43),R.jc(3,"h5",44),R.jd(4),R.zc(5,"date"),R.ic(),R.ic(),R.jc(6,"table",45),R.jc(7,"tr"),R.hd(8,x,2,1,"th",46),R.ic(),R.jc(9,"tr"),R.hd(10,T,2,1,"th",46),R.ic(),R.hd(11,C,2,3,"tr",47),R.ic(),R.ic(),R.ic()),2&e){const e=t.$implicit,i=R.yc(3);R.Pb(4),R.md(" Invoice No: ",e.invoiceNo,", ",R.Bc(5,5,e.createdDate,"dd/MM/yyyy"),""),R.Pb(4),R.Hc("ngForOf",i.headerKeys),R.Pb(2),R.Hc("ngForOf",i.headers),R.Pb(1),R.Hc("ngForOf",e.consolidatedBillDataForPDFS)}}function A(e,t){if(1&e&&(R.jc(0,"div",41),R.jc(1,"div",42),R.jc(2,"div",43),R.jc(3,"h5",44),R.jd(4),R.zc(5,"date"),R.ic(),R.ic(),R.hd(6,k,12,8,"div",40),R.ec(7,"br"),R.ec(8,"br"),R.ic(),R.ic()),2&e){const e=t.$implicit,i=R.yc(2);R.Pb(4),R.md(" Invoice No: ",e.invoiceNo,", ",R.Bc(5,3,e.createdDate,"dd/MM/yyyy"),""),R.Pb(2),R.Hc("ngForOf",i.shortReport)}}function E(e,t){if(1&e&&(R.jc(0,"div",36),R.jc(1,"div",37),R.jc(2,"div",38),R.jc(3,"span"),R.jc(4,"h3"),R.jd(5),R.ic(),R.jc(6,"span",39),R.jd(7),R.zc(8,"date"),R.ic(),R.ic(),R.ic(),R.ic(),R.hd(9,A,9,6,"div",40),R.ec(10,"br"),R.ec(11,"br"),R.ic()),2&e){const e=R.yc();R.Pb(5),R.kd(e.reportName),R.Pb(2),R.kd(R.Bc(8,3,e.currentDate,"dd/MM/yyyy")),R.Pb(2),R.Hc("ngForOf",e.shortReport)}}const Q=function(e){return{"is-invalid":e}},B=[{path:"",component:(()=>{class e{constructor(e,t,i,c,o,r,a,s,n){this.invoiceService=e,this.partyService=t,this.qualityService=i,this.shadeService=c,this.adminService=o,this.exportService=r,this.reportService=a,this.datepipe=s,this.toaster=n,this.currentDate=new Date,this.disableButton=!1,this.masterList=[],this.partyList=[],this.qualityNameList=[],this.shortReport=[],this.reportType=null,this.destroy$=new p.a,this.formSubmitted=!1,this.reportList=[{name:"Sales Report",value:"salesReport"},{name:"Sales Pending Report",value:"salesPendingReport"}],this.headerArray=[],this.headerKeys=[],this.copyHeaderKeys=[],this.apiObject={reportId:"",apiForExcel:"",apiForReport:""},this.invoiceReportRequest=new m.b}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.getReportList(),this.maxDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),this.currentDate.getDate(),23,59),this.getAllMasters(),this.getAllParties(),this.getQualityList(),this.getQualityNameList()}getReportList(){this.reportService.getAllReportType("paymentTerm").pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success&&(this.reportList=e.data)},e=>{})}getQualityNameList(){this.adminService.getAllQualityData().pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success&&(this.qualityNameList=e.data)},e=>{})}getAllMasters(){this.partyService.getAllMaster().pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success&&(this.masterList=e.data)},e=>{})}getAllParties(){this.partyService.getAllPartyList(0,"all").pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success&&(this.partyList=e.data)},e=>{})}getQualityList(){return Object(s.a)(this,void 0,void 0,(function*(){return yield new Promise((e,t)=>{this.qualityService.getQualityNameData().pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success&&(this.qualityList=e.data||[],this.qualityList&&this.qualityList.length&&this.qualityList.forEach(e=>{e.qualityEntryId=e.id}))},e=>{})})}))}getQualityFromParty(e){this.shadeService.getQualityFromParty(this.invoiceReportRequest.partyId).pipe(Object(h.a)(this.destroy$)).subscribe(e=>{e.success?(this.qualityList=e.data.qualityDataList,this.qualityList.forEach(t=>{t.partyName=e.data.partyName})):this.qualityList=null},e=>{})}getShortReport(e){this.totalAmount=0,this.totalFinishedMeter=0,this.totalGrayMeter=0,this.shortReport=[],this.formSubmitted=!0,e.valid&&(this.invoiceReportRequest.from=l(this.invoiceReportRequest.from).format(),this.invoiceReportRequest.to=l(this.invoiceReportRequest.to).format(),this.invoiceService.getShortInvoiceReport(this.invoiceReportRequest).pipe(Object(h.a)(this.destroy$)).subscribe(t=>{if(t.success&&(this.shortReport=t.data,this.shortReport&&this.shortReport.length)){let t=/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g;this.copyHeaderKeys=Object.keys(this.shortReport[0].consolidatedBillDataForPDFS[0]);let i=[];if(this.copyHeaderKeys.forEach((e,c)=>{i.push(e.replace(t,"$1$4 $2$3$5")),i[c]=i[c].charAt(0).toUpperCase()+i[c].slice(1)}),this.copyHeaderKeys=this.copyHeaderKeys.filter(e=>"List"!==e),this.headerKeys=[...this.copyHeaderKeys],this.shortReport[0].consolidatedBillDataList&&this.shortReport[0].consolidatedBillDataList.length){let e=/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g;this.headerArray=Object.keys(this.shortReport[0].consolidatedBillDataForPDFS[0]);let t=[];this.headerArray.forEach((i,c)=>{t.push(i.replace(e,"$1$4 $2$3$5")),t[c]=t[c].charAt(0).toUpperCase()+t[c].slice(1)}),this.headers=[...t],this.shortReport.forEach(e=>{e.consolidatedBillDataList.forEach(e=>{this.totalFinishedMeter+=e.totalFinishMtr,this.totalGrayMeter+=e.totalMtr,this.totalAmount+=e.taxAmt})})}this.shortReport=Object(d.sortBy)(this.shortReport,"invoiceNo"),this.printReport(e)}},e=>{}))}printReport(e){let t=new n.PrintDocument({title:""});t.append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.3.0/paper.css">'),t.append('<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">'),t.append('<link href="https://cdn.grapecity.com/wijmo/5.latest/styles/wijmo.min.css" rel="stylesheet">');let i=setInterval(()=>{let e=document.getElementById("shortReport");null!=e&&(t.append(e),clearInterval(i),setTimeout(()=>{t.print(),this.shortReport=[],this.invoiceReportRequest=new m.b,this.formSubmitted=!1},1e3))},10)}downLoadExcel(e){this.formSubmitted=!0,this.reportType?e.valid&&(this.invoiceReportRequest.from&&(this.invoiceReportRequest.from=l(this.invoiceReportRequest.from).format()),this.invoiceReportRequest.to&&(this.invoiceReportRequest.to=l(this.invoiceReportRequest.to).format()),this.invoiceService.getShortInvoiceReport(this.invoiceReportRequest).pipe(Object(h.a)(this.destroy$)).subscribe(e=>{if(e.success){let t=e.data;this.headers=Object.keys(t),this.formSubmitted=!1,this.headers.forEach(e=>{e.replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()}))}),this.exportService.exportExcel(t,"Sales Report",this.headers)}},e=>{})):(this.toaster.error("Select Report Type"),this.formSubmitted=!1)}selectedReport(e){this.reportName=e.name,this.apiObject={reportId:"",apiForExcel:"",apiForReport:""},this.apiObject.reportId=e.id,this.apiObject.apiForExcel=e.urlForExcel,this.apiObject.apiForReport=e.urlForReport,this.invoiceReportRequest.reportType=e.id}}return e.\u0275fac=function(t){return new(t||e)(R.dc(j.a),R.dc(g.a),R.dc(v.a),R.dc(f.a),R.dc(y.a),R.dc(b.a),R.dc(u.a),R.dc(c.e),R.dc(q.b))},e.\u0275cmp=R.Xb({type:e,selectors:[["ngx-payment-report"]],decls:92,vars:32,consts:[[1,"nb-header"],[1,"row"],[1,"col-md-10","col-6"],[1,"nb-text"],["invoiceForm","ngForm"],[1,"form-group","col-md-4"],[1,"required"],["name","report","appendTo","body","id","report","placeholder","Select Report",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"form-group"],["required","","name","fromDate","placeholder","Select Date",1,"form-control",3,"max","ngModel","owlDateTimeTrigger","owlDateTime","ngClass","ngModelChange"],["from","ngModel"],[3,"pickerType","afterPickerClosed"],["dtFrom1",""],["class","input-required",4,"ngIf"],["required","","name","toDate","placeholder","Select Date",1,"form-control",3,"max","disabled","ngModel","owlDateTimeTrigger","owlDateTime","min","ngClass","ngModelChange"],["to","ngModel"],["dtTo1",""],["appendTo","body","placeholder","Select Party Name","name","partyName","partyName1","ngModel",3,"ngModel","ngModelChange","change"],["partyName1","ngModel"],["disabled","true"],[1,"col-md-6","col-6"],[1,"text-left","txt-ov-elips"],[1,"text-right","txt-ov-elips"],["appendTo","body","placeholder","Select Quality Id","name","qualityId",3,"ngModel","ngModelChange"],["qualityId1","ngModel"],["name","userHeadId","appendTo","body","id","userHeadId","name","userHeadId","placeholder","Select Master",3,"ngModel","ngModelChange"],["name","qualityName","appendTo","body","id","qualityName","placeholder","Quality Name",3,"ngModel","ngModelChange"],[1,"col-md-6","mobile-btn-center","text-btn-right"],[1,"padding-bt-tp"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"disabled","click"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"click"],["id","shortReport","class","print-body",4,"ngIf"],[3,"value"],[1,"input-required"],["id","shortReport",1,"print-body"],[1,"row","report-header"],[1,"col-md-12","print-layout-report"],[1,"font-20"],["class","mb-5",4,"ngFor","ngForOf"],[1,"mb-5"],[1,"print-body"],[1,"invoice-no-heading",2,"width","fit-content"],[1,"bold-invoice",2,"font-size","18px"],[1,"print-layout-report","table-bordered","table-striped","table-process-fnt","width-100",2,"font-size","large"],[4,"ngFor","ngForOf"],[3,"background",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e){const e=R.kc();R.jc(0,"nb-card"),R.jc(1,"nb-card-header",0),R.jc(2,"div",1),R.jc(3,"div",2),R.jc(4,"h2",3),R.jd(5,"Payment Report"),R.ic(),R.ic(),R.ic(),R.ic(),R.jc(6,"nb-card-body"),R.jc(7,"form",null,4),R.jc(9,"div",1),R.jc(10,"div",5),R.jc(11,"label",6),R.jd(12,"Report Type"),R.ic(),R.jc(13,"ng-select",7),R.uc("ngModelChange",(function(e){return t.reportType=e}))("change",(function(e){return t.selectedReport(e)})),R.jc(14,"div"),R.hd(15,H,2,2,"ng-option",8),R.ic(),R.ic(),R.ic(),R.ic(),R.jc(16,"div",1),R.jc(17,"div",9),R.jc(18,"div",10),R.jc(19,"label",6),R.jd(20,"From date"),R.ic(),R.jc(21,"input",11,12),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.from=e})),R.ic(),R.jc(23,"owl-date-time",13,14),R.uc("afterPickerClosed",(function(){return null})),R.ic(),R.ic(),R.hd(25,N,3,0,"div",15),R.ic(),R.jc(26,"div",9),R.jc(27,"div",10),R.jc(28,"label",6),R.jd(29,"To date"),R.ic(),R.jc(30,"input",16,17),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.to=e})),R.ic(),R.jc(32,"owl-date-time",13,18),R.uc("afterPickerClosed",(function(){return null})),R.ic(),R.ic(),R.hd(34,D,3,0,"div",15),R.ic(),R.jc(35,"div",9),R.jc(36,"div",10),R.jc(37,"label"),R.jd(38,"Party Name"),R.ic(),R.jc(39,"ng-select",19,20),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.partyId=e}))("change",(function(e){return t.getQualityFromParty(e)})),R.jc(41,"ng-option",21),R.jc(42,"div",1),R.jc(43,"div",22),R.jc(44,"div",23),R.jd(45," Party Name "),R.ic(),R.ic(),R.jc(46,"div",22),R.jc(47,"div",24),R.jd(48," Party Code "),R.ic(),R.ic(),R.ic(),R.ic(),R.hd(49,w,8,3,"ng-option",8),R.ic(),R.ic(),R.ic(),R.ic(),R.jc(50,"div",1),R.jc(51,"div",9),R.jc(52,"div",10),R.jc(53,"label"),R.jd(54,"Quality Id"),R.ic(),R.jc(55,"ng-select",25,26),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.qualityEntryId=e})),R.jc(57,"ng-option",21),R.jc(58,"div",1),R.jc(59,"div",22),R.jc(60,"div",23),R.jd(61," Quality Id "),R.ic(),R.ic(),R.jc(62,"div",22),R.jc(63,"div",24),R.jd(64," Party Name "),R.ic(),R.ic(),R.ic(),R.ic(),R.hd(65,I,8,3,"ng-option",8),R.ic(),R.ic(),R.ic(),R.jc(66,"div",5),R.jc(67,"label"),R.jd(68,"Master Name"),R.ic(),R.jc(69,"ng-select",27),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.userHeadId=e})),R.jc(70,"div"),R.hd(71,L,2,2,"ng-option",8),R.ic(),R.ic(),R.ic(),R.jc(72,"div",5),R.jc(73,"label"),R.jd(74,"Quality Name"),R.ic(),R.jc(75,"ng-select",28),R.uc("ngModelChange",(function(e){return t.invoiceReportRequest.qualityNameId=e})),R.jc(76,"ng-option",21),R.jc(77,"div",1),R.jc(78,"div",22),R.jc(79,"div",23),R.jd(80,"Quality Name "),R.ic(),R.ic(),R.ic(),R.ic(),R.hd(81,O,5,2,"ng-option",8),R.ic(),R.ic(),R.ic(),R.jc(82,"div",1),R.jc(83,"div",29),R.jc(84,"div",30),R.jc(85,"button",31),R.uc("click",(function(){R.Xc(e);const i=R.Uc(8);return t.getShortReport(i)})),R.jd(86,"Get Report"),R.ic(),R.ic(),R.ic(),R.jc(87,"div",29),R.jc(88,"div",30),R.jc(89,"button",32),R.uc("click",(function(){R.Xc(e);const i=R.Uc(8);return t.downLoadExcel(i)})),R.jd(90,"Get Excel"),R.ic(),R.ic(),R.ic(),R.ic(),R.hd(91,E,12,6,"div",33),R.ic(),R.ic(),R.ic()}if(2&e){const e=R.Uc(22),i=R.Uc(24),c=R.Uc(31),o=R.Uc(33);R.Pb(13),R.Hc("ngModel",t.reportType),R.Pb(2),R.Hc("ngForOf",t.reportList),R.Pb(6),R.Hc("max",t.maxDate)("ngModel",t.invoiceReportRequest.from)("owlDateTimeTrigger",i)("owlDateTime",i)("ngClass",R.Nc(28,Q,e.invalid&&(t.formSubmitted||e.touched))),R.Pb(2),R.Hc("pickerType","calendar"),R.Pb(2),R.Hc("ngIf",e.invalid&&(t.formSubmitted||e.touched)),R.Pb(5),R.Hc("max",t.maxDate)("disabled",!t.invoiceReportRequest.from)("ngModel",t.invoiceReportRequest.to)("owlDateTimeTrigger",o)("owlDateTime",o)("min",t.invoiceReportRequest.from)("ngClass",R.Nc(30,Q,c.invalid&&(t.formSubmitted||c.touched))),R.Pb(2),R.Hc("pickerType","calendar"),R.Pb(2),R.Hc("ngIf",c.invalid&&(t.formSubmitted||c.touched)),R.Pb(5),R.Hc("ngModel",t.invoiceReportRequest.partyId),R.Pb(10),R.Hc("ngForOf",t.partyList),R.Pb(6),R.Hc("ngModel",t.invoiceReportRequest.qualityEntryId),R.Pb(10),R.Hc("ngForOf",t.qualityList),R.Pb(4),R.Hc("ngModel",t.invoiceReportRequest.userHeadId),R.Pb(2),R.Hc("ngForOf",t.masterList),R.Pb(4),R.Hc("ngModel",t.invoiceReportRequest.qualityNameId),R.Pb(6),R.Hc("ngForOf",t.qualityNameList),R.Pb(4),R.Hc("disabled",t.disableButton),R.Pb(6),R.Hc("ngIf",t.shortReport&&t.shortReport.length>0)}},directives:[P.u,P.x,P.t,M.x,M.m,M.n,F.a,M.l,M.o,c.m,M.a,S.c,M.t,S.e,c.l,S.b,c.n,F.c],pipes:[c.e],styles:[""]}),e})(),canActivate:[a.a],canLoad:[a.a],data:{PermissionName:["view","view group","view all"]}}];let z=(()=>{class e{}return e.\u0275mod=R.bc({type:e}),e.\u0275inj=R.ac({factory:function(t){return new(t||e)},imports:[[r.g.forChild(B)],r.g]}),e})(),K=(()=>{class e{}return e.\u0275mod=R.bc({type:e}),e.\u0275inj=R.ac({factory:function(t){return new(t||e)},imports:[[c.c,o.a,z]]}),e})()}}]);