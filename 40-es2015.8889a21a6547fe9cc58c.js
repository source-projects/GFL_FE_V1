(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"Kr/9":function(e,t,i){"use strict";i.r(t),i.d(t,"SupplierModule",(function(){return Fe}));var s=i("ofXK"),r=i("tyNb"),n=i("1G5W"),a=i("XNiG"),c=i("Cma1"),l=i("93LT"),d=i("O1SP"),o=i("4/8P"),u=i("2V/h"),p=i("dfbw"),h=i("aceb"),m=i("3jao"),g=i("qZsz"),b=i("fXoL"),f=i("1kSV"),v=i("qC+V"),j=i("3Pt+"),y=i("lDzL"),S=i("ZOsW"),P=i("+lss");const I=["searchfilter"];function k(e,t){if(1&e){const e=b.kc();b.jc(0,"nb-radio",33),b.uc("valueChange",(function(t){return b.Xc(e),b.yc().onChange(t)})),b.jd(1),b.ic()}if(2&e){const e=t.$implicit;b.Hc("value",e.id)("disabled",e.disabled)("checked",e.checked),b.Pb(1),b.ld(" ",e.value,"")}}function w(e,t){if(1&e){const e=b.kc();b.jc(0,"div",40),b.jc(1,"span",41),b.jd(2),b.ic(),b.jd(3," : "),b.jc(4,"span",42),b.jd(5),b.ic(),b.jc(6,"span",43),b.uc("click",(function(){b.Xc(e);const i=t.$implicit;return b.yc(2).onClear(i.field[0])})),b.jc(7,"strong"),b.jd(8,"x"),b.ic(),b.ic(),b.ic()}if(2&e){const e=t.$implicit;b.Pb(2),b.kd(e.field[0]),b.Pb(3),b.kd(e.value)}}function C(e,t){if(1&e){const e=b.kc();b.hc(0),b.jc(1,"div",34),b.jc(2,"label",35),b.jd(3,"Filter By : "),b.ic(),b.jc(4,"div",36),b.jc(5,"div",37),b.hd(6,w,9,2,"div",38),b.jc(7,"div",39),b.uc("click",(function(){return b.Xc(e),b.yc().onClearFilter()})),b.jd(8,"Clear All"),b.ic(),b.ic(),b.ic(),b.ic(),b.gc()}if(2&e){const e=b.yc();b.Pb(6),b.Hc("ngForOf",e.requestData.data.parameters)}}const R=function(){return{type:"zoom"}},N=function(e){return{animation:e}},x=function(e){return["/pages/supplier/edit",e]},H=function(e){return["/pages/supplier/editSupplierRate",e]};function D(e,t){if(1&e&&(b.ec(0,"nb-icon",46),b.jd(1,"\xa0\xa0 "),b.jc(2,"button",47),b.ec(3,"nb-icon",48),b.ic()),2&e){const e=t.row,i=b.yc(2);b.Hc("options",b.Nc(6,N,b.Mc(5,R)))("hidden",i.hiddenEdit)("routerLink",b.Nc(8,x,e.id)),b.Pb(2),b.Hc("routerLink",b.Nc(10,H,e.id)),b.Pb(1),b.Hc("options",b.Nc(13,N,b.Mc(12,R)))}}function T(e,t){1&e&&(b.jc(0,"ngx-datatable-column",44),b.hd(1,D,4,15,"ng-template",45),b.ic())}function E(e,t){if(1&e){const e=b.kc();b.jd(0,"Supplier Name "),b.jc(1,"div",49),b.jc(2,"nb-icon",50),b.uc("click",(function(){return b.Xc(e),b.yc().onOpenFilter("supplierName")})),b.ic(),b.ic()}if(2&e){b.yc();const e=b.Uc(50);b.Pb(2),b.Hc("nbPopover",e)}}function V(e,t){if(1&e){const e=b.kc();b.jd(0,"Discount % "),b.jc(1,"div",49),b.jc(2,"nb-icon",50),b.uc("click",(function(){return b.Xc(e),b.yc().onOpenFilter("discountPercentage")})),b.ic(),b.ic()}if(2&e){b.yc();const e=b.Uc(50);b.Pb(2),b.Hc("nbPopover",e)}}function q(e,t){if(1&e){const e=b.kc();b.jd(0,"GST % "),b.jc(1,"div",49),b.jc(2,"nb-icon",50),b.uc("click",(function(){return b.Xc(e),b.yc().onOpenFilter("gstPercentage")})),b.ic(),b.ic()}if(2&e){b.yc();const e=b.Uc(50);b.Pb(2),b.Hc("nbPopover",e)}}function M(e,t){if(1&e){const e=b.kc();b.jd(0,"Payment Terms "),b.jc(1,"div",49),b.jc(2,"nb-icon",50),b.uc("click",(function(){return b.Xc(e),b.yc().onOpenFilter("paymentTerms")})),b.ic(),b.ic()}if(2&e){b.yc();const e=b.Uc(50);b.Pb(2),b.Hc("nbPopover",e)}}function L(e,t){if(1&e){const e=b.kc();b.jd(0,"Remark "),b.jc(1,"div",49),b.jc(2,"nb-icon",50),b.uc("click",(function(){return b.Xc(e),b.yc().onOpenFilter("remark")})),b.ic(),b.ic()}if(2&e){b.yc();const e=b.Uc(50);b.Pb(2),b.Hc("nbPopover",e)}}function A(e,t){if(1&e&&(b.jc(0,"option",51),b.jd(1),b.ic()),2&e){const e=t.$implicit;b.Hc("value",e),b.Pb(1),b.kd(e)}}function F(e,t){if(1&e){const e=b.kc();b.hc(0),b.jc(1,"ng-select",63),b.uc("ngModelChange",(function(t){return b.Xc(e),b.yc(2).operatorSelected=t})),b.jc(2,"ng-option",64),b.jd(3,"Conatins"),b.ic(),b.jc(4,"ng-option",65),b.jd(5,"Equals"),b.ic(),b.jc(6,"ng-option",66),b.jd(7,"Not Equals"),b.ic(),b.jc(8,"ng-option",67),b.jd(9,"Starts With"),b.ic(),b.jc(10,"ng-option",68),b.jd(11,"Ends With"),b.ic(),b.ic(),b.gc()}if(2&e){const e=b.yc(2);b.Pb(1),b.Hc("ngModel",e.operatorSelected)}}function B(e,t){if(1&e){const e=b.kc();b.hc(0),b.jc(1,"ng-select",63),b.uc("ngModelChange",(function(t){return b.Xc(e),b.yc(2).operatorSelected=t})),b.jc(2,"ng-option",69),b.jd(3,"Greater Than"),b.ic(),b.jc(4,"ng-option",70),b.jd(5,"Less Than"),b.ic(),b.jc(6,"ng-option",65),b.jd(7,"Equals"),b.ic(),b.jc(8,"ng-option",66),b.jd(9,"Not Equals"),b.ic(),b.ic(),b.gc()}if(2&e){const e=b.yc(2);b.Pb(1),b.Hc("ngModel",e.operatorSelected)}}function O(e,t){if(1&e){const e=b.kc();b.jc(0,"div",52),b.jc(1,"div",53),b.jc(2,"div",54),b.jc(3,"span",55),b.jd(4,"Filter"),b.ic(),b.ic(),b.jc(5,"div",56),b.jc(6,"div",57),b.uc("click",(function(){return b.Xc(e),b.yc().closeFilterPopover()})),b.jc(7,"strong"),b.jd(8,"X"),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(9,"div",58),b.jc(10,"div",59),b.hd(11,F,12,1,"ng-container",20),b.hd(12,B,10,1,"ng-container",20),b.ic(),b.jc(13,"div",59),b.jc(14,"input",60),b.uc("ngModelChange",(function(t){return b.Xc(e),b.yc().filterWord=t})),b.ic(),b.ic(),b.ic(),b.jc(15,"button",61),b.uc("click",(function(){return b.Xc(e),b.yc().onApplyFilter()})),b.jd(16,"Apply"),b.ic(),b.jc(17,"button",62),b.uc("click",(function(){return b.Xc(e),b.yc().closeFilterPopover()})),b.jd(18,"Close"),b.ic(),b.ic()}if(2&e){const e=b.yc();b.Pb(11),b.Hc("ngIf",e.stringFlag),b.Pb(1),b.Hc("ngIf",e.numberFlag),b.Pb(2),b.Hc("ngModel",e.filterWord)}}const U=function(){return["/pages/supplier"]};let X=(()=>{class e{constructor(e,t,i,s){this.commonService=e,this.supplierService=t,this.supplierGuard=i,this.modalService=s,this.loading=!1,this.tableStyle="bootstrap",this.tableHeaders=["supplierName","discountPercentage","gstPercentage","paymentTerms","remark"],this.errorData=d,this.supplierList=[],this.copySupplierList=[],this.supplier=[],this.headers=["Supplier Name","Discount%","GST%","Payment Terms","Remark"],this.module="supplier",this.radioSelect=0,this.flag=!1,this.disabled=!1,this.radioArray=[{id:1,value:"View Own",disabled:!1,checked:!1},{id:2,value:"View Group",disabled:!1,checked:!1},{id:3,value:"View All",disabled:!1,checked:!0}],this.hidden=!0,this.hiddenEdit=!0,this.hiddenView=!0,this.ownDelete=!0,this.allDelete=!0,this.groupDelete=!0,this.ownEdit=!0,this.allEdit=!0,this.groupEdit=!0,this.searchStr="",this.searchANDCondition=!1,this.destroy$=new a.a,this.numberFlag=!1,this.stringFlag=!1,this.pageSizes=[10,20,50,100],this.selectedPageSize=20,this.requestData=new p.a,this.filterWord="",this.selectedColumnForFilter="",this.operatorSelected=null}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.requestData.data=new m.a,this.requestData.getBy="all",this.getSupplierList(),this.userId=this.commonService.getUser(),this.userId=this.userId.userId,this.userHeadId=this.commonService.getUserHeadId(),this.userHeadId=this.userHeadId.userHeadId,this.getViewAccess(),this.getAddAcess(),this.getDeleteAccess(),this.getDeleteAccess1(),this.getEditAccess(),this.getEditAccess1(),this.supplierGuard.accessRights("view all")?(this.requestData.getBy="all",this.getSupplierList(),this.hidden=this.allDelete,this.hiddenEdit=this.allEdit,this.radioSelect=3):this.supplierGuard.accessRights("view group")?(this.requestData.getBy="group",this.getSupplierList(),this.hidden=this.groupDelete,this.hiddenEdit=this.groupEdit,this.radioSelect=2):this.supplierGuard.accessRights("view")&&(this.requestData.getBy="own",this.getSupplierList(),this.hidden=this.ownDelete,this.hiddenEdit=this.ownEdit,this.radioSelect=1)}getAddAcess(){this.disabled=!this.supplierGuard.accessRights("add")}onChange(e){switch(this.supplierList=[],e){case 1:this.requestData.getBy="own",this.getSupplierList(),this.hidden=this.ownDelete,this.hiddenEdit=this.ownEdit;break;case 2:this.requestData.getBy="group",this.getSupplierList(),this.hidden=this.groupDelete,this.hiddenEdit=this.groupEdit;break;case 3:this.requestData.getBy="all",this.getSupplierList(),this.hidden=this.allDelete,this.hiddenEdit=this.allEdit}}open(){this.flag=!0;const e=this.modalService.open(c.a);e.componentInstance.headers=this.headers,e.componentInstance.list=this.supplier,e.componentInstance.moduleName=this.module}filter(e){const t=e.toString().toLowerCase().trim(),i=Object.keys(this.copySupplierList[0]);this.supplierList=this.copySupplierList.filter(e=>{for(let s=0;s<i.length;s++)if(e[i[s]]&&-1!==e[i[s]].toString().toLowerCase().indexOf(t)||!t)return!0})}getSupplierList(){this.loading=!0,this.supplierService.getAllSupplierV1(this.requestData).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{if(e.success){const t=e.data;this.supplierList=t.data,this.requestData.data.total=t.total,this.supplier=this.supplierList.map(e=>({id:e.id,supplierName:e.supplierName,discountPercentage:e.discountPercentage,gstPercentage:e.gstPercentage,paymentTerms:e.paymentTerms,remark:e.remark})),this.copySupplierList=this.supplierList.map(e=>({id:e.id,supplierName:e.supplierName,discountPercentage:e.discountPercentage,gstPercentage:e.gstPercentage,paymentTerms:e.paymentTerms,remark:e.remark}))}this.loading=!1},e=>{this.loading=!1})}getViewAccess(){this.radioArray[0].disabled=!this.supplierGuard.accessRights("view"),this.radioArray[1].disabled=!this.supplierGuard.accessRights("view group"),this.radioArray[2].disabled=!this.supplierGuard.accessRights("view all")}getDeleteAccess(){this.supplierGuard.accessRights("delete")&&(this.ownDelete=!1,this.hidden=this.ownDelete),this.supplierGuard.accessRights("delete group")&&(this.groupDelete=!1,this.hidden=this.groupDelete),this.supplierGuard.accessRights("delete all")&&(this.allDelete=!1,this.hidden=this.allDelete)}getDeleteAccess1(){this.supplierGuard.accessRights("delete")?(this.ownDelete=!1,this.hidden=this.ownDelete):this.hidden=!0}getEditAccess(){this.supplierGuard.accessRights("edit")&&(this.ownEdit=!1,this.hiddenEdit=this.ownEdit),this.supplierGuard.accessRights("edit group")&&(this.groupEdit=!1,this.hiddenEdit=this.groupEdit),this.supplierGuard.accessRights("edit all")&&(this.allEdit=!1,this.hiddenEdit=this.allEdit)}getEditAccess1(){this.supplierGuard.accessRights("edit")?(this.ownEdit=!1,this.hiddenEdit=this.ownEdit):this.hiddenEdit=!0}setPage(e){this.requestData.data.pageIndex=e.offset,this.getSupplierList()}pageSizeChanged(){this.requestData.data.pageSize=Number(this.selectedPageSize),this.getSupplierList()}onOpenFilter(e){"supplierName"==e||"remark"==e?(this.stringFlag=!0,this.numberFlag=!1):(this.numberFlag=!0,this.stringFlag=!1);const t=this.requestData.data.parameters.findIndex(t=>t.field.find(t=>t==e));t>-1?(this.filterWord=this.requestData.data.parameters[t].value,this.operatorSelected=this.requestData.data.parameters[t].operator):(this.filterWord="",this.operatorSelected=null),this.selectedColumnForFilter=e,this.popover.show()}onApplyFilter(){this.popover.hide();const e=this.requestData.data.parameters.findIndex(e=>e.field.find(e=>e==this.selectedColumnForFilter));if(e>-1)this.requestData.data.parameters[e].operator=this.operatorSelected,this.requestData.data.parameters[e].value=this.filterWord;else{let e=new g.a;e.field=[this.selectedColumnForFilter],e.value=this.filterWord,e.operator=this.operatorSelected,this.requestData.data.parameters.push(e)}this.requestData.data.pageIndex=0,this.getSupplierList()}onClear(e){let t;t=this.requestData.data.parameters.findIndex(e?t=>t.field.find(t=>t==e):e=>e.field.find(e=>e==this.selectedColumnForFilter)),t>-1&&(this.filterWord="",this.operatorSelected=null,this.requestData.data.parameters.splice(t,1),this.requestData.data.pageIndex=0,this.getSupplierList())}closeFilterPopover(){this.popover.hide()}onClearFilter(){this.popover.hide(),this.requestData.data.parameters.length>0&&(this.requestData.data.parameters=[],this.getSupplierList())}}return e.\u0275fac=function(t){return new(t||e)(b.dc(o.a),b.dc(u.a),b.dc(l.a),b.dc(f.e))},e.\u0275cmp=b.Xb({type:e,selectors:[["ngx-supplier"]],viewQuery:function(e,t){var i;1&e&&(b.cd(I,!0),b.nd(h.ab,!0)),2&e&&(b.Tc(i=b.vc())&&(t.filterTextBox=i.first),b.Tc(i=b.vc())&&(t.popover=i.first))},decls:51,vars:25,consts:[[3,"show"],[1,"nb-style"],[1,"nb-header"],[1,"row"],[1,"col-md-1","col-3","display-flex-start","max-width-device"],[1,"btn","btn-primary","btn-md","btn-design",3,"routerLink","disabled"],[1,"col-md-9","col-8"],[1,"nb-text"],[1,"col-md-2","col-2","display-flex-start","desktop-justify-flexend"],[1,"btn","btn-primary","btn-md","btn-design",3,"click"],[1,"col-md-6"],[1,"radio-flex-between","mr-16","mobile-pr-0",3,"ngModel","ngModelChange"],[3,"value","disabled","checked","valueChange",4,"ngFor","ngForOf"],[1,"col-md-4"],[2,"display","flex"],[2,"margin-top","4px","margin-right","2px"],["status","primary","labelPosition","start","name","shift",3,"ngModel","ngModelChange"],[2,"margin-top","4px","margin-left","2px"],[1,"col-md-8"],["type","text","placeholder","Search","aria-label","Search","aria-describedby","basic-addon1",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"material","table-responsive",3,"rows","ngClass","headerHeight","footerHeight","externalPaging","count","offset","limit","page"],["name","Action","sortable","false","prop","id",4,"ngIf"],["name","Supplier Name","prop","supplierName"],["ngx-datatable-header-template",""],["name","Discount %","prop","discountPercentage"],["name","GST %","prop","gstPercentage"],["name","Payment Terms","prop","paymentTerms"],["name","Remark","prop","remark"],[1,"page-sizer","d-flex"],["name","pageSizer",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["templateRef",""],[3,"value","disabled","checked","valueChange"],[1,"filter-by-row"],["for",""],[1,"filter-by-col"],[1,"tag-style-con"],["class","tag-style",4,"ngFor","ngForOf"],[1,"filter-by-clear-all",3,"click"],[1,"tag-style"],[1,"filter-by-title"],[1,"filter-by-val"],[2,"cursor","pointer",3,"click"],["name","Action","sortable","false","prop","id"],["ngx-datatable-cell-template",""],["ngbTooltip","Tooltip on bottom","status","primary","icon","edit",3,"options","hidden","routerLink"],["nbTooltip","Update Supplier Rate","placement","auto","nbTooltipStatus","success","nbTooltipPlacement","bottom","nbButton","",1,"btn","primary-status","nb-supplier-icon",3,"routerLink"],["status","primary","icon","menu",3,"options"],[1,"filter-icon"],["icon","menu-outline","nbPopoverTrigger","noop",1,"nb-icon-filter",3,"nbPopover","click"],[3,"value"],["id","filterDiv",2,"padding","2px 14px","width","250px"],[1,"row",2,"background-color","#aa3634"],[1,"col-md-10"],[2,"color","white"],[1,"col-md-2",2,"margin-top","3px","color","white"],[2,"cursor","pointer","text-align","center",3,"click"],[1,"row",2,"margin-top","8px"],[1,"col-md-12","mb-1"],["type","text","placeholder","Filter...",1,"form-control",3,"ngModel","ngModelChange"],["nbButton","","status","primary",2,"margin-right","5px",3,"click"],["nbButton","","status","danger",3,"click"],["appendTo","body","placeholder","Select Filter",1,"popup-select",3,"ngModel","ngModelChange"],["value","LIKE"],["value","EQUALS"],["value","NOT_EQUALS"],["value","START_WITH"],["value","END_WITH"],["value","GREATER_THAN"],["value","LESS_THAN"]],template:function(e,t){1&e&&(b.ec(0,"ngx-loading",0),b.jc(1,"nb-card",1),b.jc(2,"nb-card-header",2),b.jc(3,"div",3),b.jc(4,"div",4),b.jc(5,"button",5),b.jd(6,"ADD"),b.ic(),b.ic(),b.jc(7,"div",6),b.jc(8,"h2",7),b.jd(9,"Supplier"),b.ic(),b.ic(),b.jc(10,"div",8),b.jc(11,"button",9),b.uc("click",(function(){return t.open()})),b.jd(12,"EXPORT"),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(13,"nb-card-body"),b.jc(14,"div",3),b.jc(15,"div",10),b.jc(16,"nb-radio-group",11),b.uc("ngModelChange",(function(e){return t.radioSelect=e})),b.hd(17,k,2,4,"nb-radio",12),b.ic(),b.ic(),b.jc(18,"div",10),b.jc(19,"div",3),b.jc(20,"div",13),b.jc(21,"div",14),b.jc(22,"p",15),b.jd(23,"OR"),b.ic(),b.jc(24,"nb-toggle",16),b.uc("ngModelChange",(function(){return t.getSupplierList()}))("ngModelChange",(function(e){return t.requestData.data.isAnd=e})),b.ic(),b.jc(25,"p",17),b.jd(26,"AND"),b.ic(),b.ic(),b.ic(),b.jc(27,"div",18),b.jc(28,"input",19),b.uc("ngModelChange",(function(e){return t.searchStr=e})),b.ic(),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(29,"div",3),b.hd(30,C,9,1,"ng-container",20),b.ic(),b.jc(31,"ngx-datatable",21),b.uc("page",(function(e){return t.setPage(e)})),b.zc(32,"searchInTable"),b.hd(33,T,2,0,"ngx-datatable-column",22),b.jc(34,"ngx-datatable-column",23),b.hd(35,E,3,1,"ng-template",24),b.ic(),b.jc(36,"ngx-datatable-column",25),b.hd(37,V,3,1,"ng-template",24),b.ic(),b.jc(38,"ngx-datatable-column",26),b.hd(39,q,3,1,"ng-template",24),b.ic(),b.jc(40,"ngx-datatable-column",27),b.hd(41,M,3,1,"ng-template",24),b.ic(),b.jc(42,"ngx-datatable-column",28),b.hd(43,L,3,1,"ng-template",24),b.ic(),b.ic(),b.jc(44,"div",29),b.jc(45,"span"),b.jd(46,"Page Size: "),b.ic(),b.jc(47,"select",30),b.uc("ngModelChange",(function(e){return t.selectedPageSize=e}))("change",(function(){return t.pageSizeChanged()})),b.hd(48,A,2,2,"option",31),b.ic(),b.ic(),b.ic(),b.ic(),b.hd(49,O,19,3,"ng-template",null,32,b.id)),2&e&&(b.Hc("show",t.loading),b.Pb(5),b.Hc("routerLink",b.Mc(24,U))("disabled",t.disabled),b.Pb(11),b.Hc("ngModel",t.radioSelect),b.Pb(1),b.Hc("ngForOf",t.radioArray),b.Pb(7),b.Hc("ngModel",t.requestData.data.isAnd),b.Pb(4),b.Hc("ngModel",t.searchStr),b.Pb(2),b.Hc("ngIf",t.requestData.data.parameters&&t.requestData.data.parameters.length),b.Pb(1),b.Hc("rows",b.Dc(32,19,t.supplierList,t.searchStr,t.requestData.data.isAnd,t.tableHeaders))("ngClass","bootstrap")("headerHeight",31)("footerHeight",40)("externalPaging",!0)("count",t.requestData.data.total)("offset",t.requestData.data.pageIndex)("limit",t.requestData.data.pageSize),b.Pb(2),b.Hc("ngIf",!t.hiddenEdit||!t.hidden),b.Pb(14),b.Hc("ngModel",t.selectedPageSize),b.Pb(1),b.Hc("ngForOf",t.pageSizes))},directives:[v.a,h.u,h.x,r.d,h.t,h.eb,j.l,j.o,s.m,h.wb,j.a,s.n,y.e,s.l,y.b,y.c,j.u,h.db,y.a,h.I,h.q,h.yb,h.ab,j.p,j.w,S.a,S.c],pipes:[P.a],styles:[".primary-status[_ngcontent-%COMP%]{background-color:#fff;background-color:transparent!important;border-color:transparent!important}"]}),e})();var G=i("8k+d"),z=i("5eHb");function _(e,t){1&e&&(b.jc(0,"div"),b.jc(1,"h2",25),b.jd(2,"Add Supplier"),b.ic(),b.ic())}function $(e,t){1&e&&(b.jc(0,"h2",25),b.jd(1,"Update Supplier"),b.ic())}function W(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"Supplier Name is Required"),b.ic(),b.ic())}function J(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"Supplier name already exists"),b.ic(),b.ic())}function K(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"Discount % is required"),b.ic(),b.ic())}function Q(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"Discount % should be less than 100 "),b.ic(),b.ic())}function Z(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"GST % is required"),b.ic(),b.ic())}function Y(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"GST % should be less than 100 "),b.ic(),b.ic())}function ee(e,t){1&e&&(b.jc(0,"div",26),b.jc(1,"span"),b.jd(2,"Payment Terms is Required"),b.ic(),b.ic())}function te(e,t){if(1&e){const e=b.kc();b.jc(0,"button",27),b.uc("click",(function(){return b.Xc(e),b.yc().reset()})),b.jd(1,"CANCEL"),b.ic()}}const ie=function(){return["/pages/supplier/view"]};function se(e,t){1&e&&(b.jc(0,"button",28,23),b.jd(2,"CANCEL"),b.ic()),2&e&&b.Hc("routerLink",b.Mc(1,ie))}function re(e,t){if(1&e){const e=b.kc();b.jc(0,"button",29),b.uc("click",(function(){return b.Xc(e),b.yc().updateSupplier()})),b.jd(1,"UPDATE"),b.ic()}if(2&e){const e=b.yc();b.Hc("disabled",e.disableButton)}}function ne(e,t){if(1&e&&(b.jc(0,"button",30),b.jd(1,"SAVE"),b.ic()),2&e){const e=b.yc();b.Hc("disabled",e.disableButton)}}const ae=function(e){return{"is-invalid":e}};let ce=(()=>{class e{constructor(e,t,i,s,r,n){this.commonService=e,this.supplierService=t,this.router=i,this._route=s,this.toastr=r,this.partyService=n,this.errorData=d,this.formSubmitted=!1,this.loading=!1,this.disableButton=!1,this.isSupplierNameExists=!1,this.destroy$=new a.a}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.getdata(),this.getUpdateData(),this.getMaster()}getMaster(){this.loading=!0,this.master=[],this.partyService.getAllMaster().pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success?(this.master=e.data,this.loading=!1):this.loading=!1},e=>{this.loading=!1})}getdata(){this.user=this.commonService.getUser(),this.userHead=this.commonService.getUserHeadId(),this.addSupplier=new j.e({supplierName:new j.c(null,j.v.required),discountPercentage:new j.c(null,[j.v.required,j.v.max(100),j.v.min(0)]),gstPercentage:new j.c(null,[j.v.required,j.v.max(100),j.v.min(0)]),paymentTerms:new j.c(null,j.v.required),remark:new j.c(null),userHeadId:new j.c(null),createdBy:new j.c(null),updatedBy:new j.c(null)}),this.selectedSupplierId=this._route.snapshot.paramMap.get("id")}getUpdateData(){null!=this.selectedSupplierId&&this.supplierService.getAllSupplierById(this.selectedSupplierId).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{this.currentSupplier=e.data,this.addSupplier.patchValue({supplierName:this.currentSupplier.supplierName,discountPercentage:this.currentSupplier.discountPercentage,gstPercentage:this.currentSupplier.gstPercentage,paymentTerms:this.currentSupplier.paymentTerms,remark:this.currentSupplier.remark,createdBy:this.currentSupplier.user,id:this.selectedSupplierId,userHeadId:this.currentSupplier.userHeadId})},e=>{})}reset(){this.addSupplier.reset(),this.formSubmitted=!1}addSupplierInfo(){this.disableButton=!0,this.formSubmitted=!0,this.addSupplier.valid&&!this.isSupplierNameExists?(this.addSupplier.value.createdBy=this.user.userId,this.supplierService.addSupplierInSystem(this.addSupplier.value).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success?(this.toastr.success(e.msg),this.addSupplier.reset(),this.formSubmitted=!1):this.toastr.error(e.msg),this.disableButton=!1},e=>{this.disableButton=!1,this.toastr.error(d.Serever_Error)})):this.disableButton=!1}updateSupplier(){if(this.disableButton=!0,this.formSubmitted=!0,this.addSupplier.valid&&!this.isSupplierNameExists){this.addSupplier.value.updatedBy=this.user.userId;let e=Object.assign(Object.assign({},this.addSupplier.value),{id:this.selectedSupplierId});this.supplierService.updateSupplierById(e).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success?(this.toastr.success(e.msg),this.router.navigate(["pages/supplier"])):this.toastr.error(e.msg),this.disableButton=!1,this.loading=!1},e=>{this.disableButton=!1,this.toastr.error(d.Serever_Error),this.loading=!1})}this.disableButton=!1}isUniqueSupplierName(){if(this.isSupplierNameExists=!1,this.addSupplier.value.supplierName){let e=0;this.addSupplier.value.id&&(e=this.addSupplier.value.id),this.supplierService.isSupplierExists(this.addSupplier.value.supplierName,e).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success&&(this.isSupplierNameExists=e.data)},e=>{})}}tableChange(e){"view table"===e&&this.router.navigate(["/pages/supplier/view"])}}return e.\u0275fac=function(t){return new(t||e)(b.dc(o.a),b.dc(u.a),b.dc(r.c),b.dc(r.a),b.dc(z.b),b.dc(G.a))},e.\u0275cmp=b.Xb({type:e,selectors:[["ngx-add-edit-supplier"]],features:[b.Ob([s.j])],decls:54,vars:26,consts:[[1,"nb-style"],[1,"nb-header"],[1,"row"],[1,"col-md-5","col-6","display-flex-start","max-width-device"],["placeholder","Select",1,"btn","btn-md",3,"change"],["value","view table"],[1,"col-md-7","col-6"],[4,"ngIf","ngIfElse"],["updateS",""],[3,"formGroup","ngSubmit"],[1,"col-md-4"],[1,"form-group"],[1,"required"],["type","text","nbinput","","fieldsize","small","name","supplierName","placeholder","Supplier Name","formControlName","supplierName",1,"form-control","size-small",3,"ngClass","change"],["class","input-required",4,"ngIf"],["type","number","nbinput","","fieldsize","small","id","discountPercentage","placeholder","Discount %","onkeypress","return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57  || event.charCode == 46","formControlName","discountPercentage","maxlength","3","min","0","max","100",1,"form-control","size-small",3,"ngClass"],["type","number","nbinput","","fieldsize","small","id","gstPercentage","placeholder","GST %","onkeypress","return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57  || event.charCode == 46","formControlName","gstPercentage","min","0",1,"form-control","size-small",3,"ngClass"],["type","number","nbinput","","fieldsize","small","id","paymentTerms","placeholder","Payment Terms","onkeypress","return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57  || event.charCode == 46","formControlName","paymentTerms","required","","min","0",1,"form-control","size-small",3,"ngClass"],["type","text","id","remark","placeholder","Remark","formControlName","remark",1,"form-control","remark-resize"],[1,"col-md-12","mobile-btn-center","text-btn-right"],[1,"padding-bt-tp"],["class","btn btn-primary btn-sm btn-design-cancel","type","button",3,"click",4,"ngIf"],["class","btn btn-primary btn-sm btn-design-cancel","type","button",3,"routerLink",4,"ngIf"],["update",""],["type","submit","class","btn btn-primary btn-sm btn-design-save button-base ripple","value","SAVE",3,"disabled",4,"ngIf","ngIfElse"],[1,"nb-text"],[1,"input-required"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-cancel",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-cancel",3,"routerLink"],["type","button","value","UPDATE",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"disabled","click"],["type","submit","value","SAVE",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"disabled"]],template:function(e,t){if(1&e&&(b.jc(0,"nb-card",0),b.jc(1,"nb-card-header",1),b.jc(2,"div",2),b.jc(3,"div",3),b.jc(4,"ng-select",4),b.uc("change",(function(e){return t.tableChange(e)})),b.jc(5,"ng-option",5),b.jd(6,"View Table"),b.ic(),b.ic(),b.ic(),b.jc(7,"div",6),b.hd(8,_,3,0,"div",7),b.hd(9,$,2,0,"ng-template",null,8,b.id),b.ic(),b.ic(),b.ic(),b.jc(11,"nb-card-body"),b.jc(12,"form",9),b.uc("ngSubmit",(function(){return t.addSupplierInfo()})),b.jc(13,"div",2),b.jc(14,"div",10),b.jc(15,"div",11),b.jc(16,"label",12),b.jd(17,"Supplier Name"),b.ic(),b.jc(18,"input",13),b.uc("change",(function(){return t.isUniqueSupplierName()})),b.ic(),b.hd(19,W,3,0,"div",14),b.hd(20,J,3,0,"div",14),b.ic(),b.ic(),b.jc(21,"div",10),b.jc(22,"div",11),b.jc(23,"label",12),b.jd(24,"Discount %"),b.ic(),b.ec(25,"input",15),b.hd(26,K,3,0,"div",14),b.hd(27,Q,3,0,"div",14),b.ic(),b.ic(),b.jc(28,"div",10),b.jc(29,"div",11),b.jc(30,"label",12),b.jd(31,"GST %"),b.ic(),b.ec(32,"input",16),b.hd(33,Z,3,0,"div",14),b.hd(34,Y,3,0,"div",14),b.ic(),b.ic(),b.jc(35,"div",10),b.jc(36,"div",11),b.jc(37,"label",12),b.jd(38,"Payment Terms"),b.ic(),b.ec(39,"input",17),b.hd(40,ee,3,0,"div",14),b.ic(),b.ic(),b.jc(41,"div",10),b.jc(42,"div",11),b.jc(43,"label"),b.jd(44,"Remark"),b.ic(),b.ec(45,"input",18),b.ic(),b.ic(),b.ic(),b.jc(46,"div",2),b.jc(47,"div",19),b.jc(48,"div",20),b.hd(49,te,2,0,"button",21),b.hd(50,se,3,2,"button",22),b.hd(51,re,2,1,"ng-template",null,23,b.id),b.hd(53,ne,2,1,"button",24),b.ic(),b.ic(),b.ic(),b.ic(),b.ic(),b.ic()),2&e){const e=b.Uc(10),i=b.Uc(52);b.Pb(8),b.Hc("ngIf",null==t.selectedSupplierId)("ngIfElse",e),b.Pb(4),b.Hc("formGroup",t.addSupplier),b.Pb(6),b.Hc("ngClass",b.Nc(18,ae,t.addSupplier.controls.supplierName.invalid&&(t.formSubmitted||t.addSupplier.controls.supplierName.touched)||t.isSupplierNameExists)),b.Pb(1),b.Hc("ngIf",t.addSupplier.controls.supplierName.invalid&&(t.formSubmitted||t.addSupplier.controls.supplierName.touched)),b.Pb(1),b.Hc("ngIf",t.isSupplierNameExists),b.Pb(5),b.Hc("ngClass",b.Nc(20,ae,t.addSupplier.controls.discountPercentage.invalid&&(t.formSubmitted||t.addSupplier.controls.discountPercentage.touched))),b.Pb(1),b.Hc("ngIf",null==t.addSupplier.get("discountPercentage").errors?null:t.addSupplier.get("discountPercentage").errors.required),b.Pb(1),b.Hc("ngIf",null==t.addSupplier.get("discountPercentage").errors?null:t.addSupplier.get("discountPercentage").errors.max),b.Pb(5),b.Hc("ngClass",b.Nc(22,ae,t.addSupplier.controls.gstPercentage.invalid&&(t.formSubmitted||t.addSupplier.controls.gstPercentage.touched))),b.Pb(1),b.Hc("ngIf",null==t.addSupplier.get("gstPercentage").errors?null:t.addSupplier.get("gstPercentage").errors.required),b.Pb(1),b.Hc("ngIf",null==t.addSupplier.get("gstPercentage").errors?null:t.addSupplier.get("gstPercentage").errors.max),b.Pb(5),b.Hc("ngClass",b.Nc(24,ae,t.addSupplier.controls.paymentTerms.invalid&&(t.formSubmitted||t.addSupplier.controls.paymentTerms.touched))),b.Pb(1),b.Hc("ngIf",t.addSupplier.controls.paymentTerms.invalid&&(t.formSubmitted||t.addSupplier.controls.paymentTerms.touched)),b.Pb(9),b.Hc("ngIf",!t.selectedSupplierId),b.Pb(1),b.Hc("ngIf",t.selectedSupplierId),b.Pb(3),b.Hc("ngIf",!t.selectedSupplierId)("ngIfElse",i)}},directives:[h.u,h.x,S.a,S.c,s.n,h.t,j.x,j.m,j.f,j.a,j.l,j.d,s.l,j.q,j.h,j.t,r.d],styles:[""]}),e})();function le(e,t){1&e&&(b.jc(0,"div"),b.jc(1,"h2",30),b.jd(2,"ADD SUPPLIER RATE"),b.ic(),b.ic())}function de(e,t){1&e&&(b.jc(0,"h2",30),b.jd(1,"UPDATE SUPPLIER RATE"),b.ic())}function oe(e,t){if(1&e&&(b.jc(0,"ng-option",36),b.jd(1),b.ic()),2&e){const e=t.$implicit;b.Hc("value",e.id),b.Pb(1),b.md("",e.supplierName," - ",e.id,"")}}function ue(e,t){1&e&&(b.jc(0,"div",37),b.jc(1,"span"),b.jd(2,"Supplier Name is required"),b.ic(),b.ic())}const pe=function(e){return{"is-invalid":e}};function he(e,t){if(1&e){const e=b.kc();b.jc(0,"div",12),b.jc(1,"label",31),b.jd(2,"Supplier Name"),b.ic(),b.jc(3,"ng-select",32,33),b.uc("ngModelChange",(function(t){return b.Xc(e),b.yc().formValues.supplierRates[0].supplierId=t}))("change",(function(){b.Xc(e);const t=b.yc();return t.getDetail(t.formValues.supplierRates[0].supplierId)})),b.hd(5,oe,2,3,"ng-option",34),b.ic(),b.hd(6,ue,3,0,"div",35),b.ic()}if(2&e){const e=b.Uc(4),t=b.yc();b.Pb(3),b.Hc("ngModel",t.formValues.supplierRates[0].supplierId)("ngClass",b.Nc(4,pe,e.invalid&&(t.formSubmitted||e.touched))),b.Pb(2),b.Hc("ngForOf",t.supplier),b.Pb(1),b.Hc("ngIf",e.invalid&&(t.formSubmitted||e.touched))}}function me(e,t){if(1&e){const e=b.kc();b.jc(0,"label",31),b.jd(1,"Supplier Name:"),b.ic(),b.jc(2,"select",38,33),b.uc("ngModelChange",(function(t){return b.Xc(e),b.yc().formValues.id=t})),b.jc(4,"option",39),b.jd(5),b.ic(),b.ic()}if(2&e){const e=b.yc();b.Pb(2),b.Hc("ngModel",e.formValues.id),b.Pb(2),b.Hc("value",e.formValues.id),b.Pb(1),b.ld(" ",e.formValues.supplierName,"")}}function ge(e,t){1&e&&(b.jc(0,"div",37),b.jc(1,"span"),b.jd(2,"Required"),b.ic(),b.ic())}function be(e,t){if(1&e){const e=b.kc();b.jc(0,"input",40,41),b.uc("keyup",(function(i){b.Xc(e);const s=t.rowIndex;return b.yc().onKeyUp(i,s,0,"itemName")}))("change",(function(i){b.Xc(e);const s=t.rowIndex;return b.yc().checkDuplicateLocally(i,s)}))("ngModelChange",(function(i){return b.Xc(e),t.row.itemName=i})),b.ic(),b.hd(2,ge,3,0,"div",35)}if(2&e){const e=t.row,i=t.rowIndex,s=b.Uc(1),r=b.yc();b.Jc("name","tableSupplierItemName",i,""),b.Hc("id","supplierList"+i+"-0")("ngModel",e.itemName)("ngClass",b.Nc(5,pe,r.formSubmitted&&s.invalid)),b.Pb(2),b.Hc("ngIf",r.formSubmitted&&s.invalid)}}function fe(e,t){1&e&&(b.jc(0,"div",37),b.jc(1,"span"),b.jd(2,"Required"),b.ic(),b.ic())}function ve(e,t){if(1&e){const e=b.kc();b.jc(0,"ng-select",42,43),b.uc("ngModelChange",(function(i){return b.Xc(e),t.row.itemType=i})),b.jc(2,"ng-option",44),b.jd(3,"Color"),b.ic(),b.jc(4,"ng-option",45),b.jd(5,"Chemical"),b.ic(),b.ic(),b.hd(6,fe,3,0,"div",35)}if(2&e){const e=t.row,i=t.rowIndex,s=b.Uc(1),r=b.yc();b.Jc("name","tableSupplierItemType",i,""),b.Hc("ngModel",e.itemType)("id","supplierList"+i+"-1")("ngClass",b.Nc(5,pe,r.formSubmitted&&s.invalid)),b.Pb(6),b.Hc("ngIf",r.formSubmitted&&s.invalid)}}function je(e,t){1&e&&(b.jc(0,"div",37),b.jc(1,"span"),b.jd(2,"Required"),b.ic(),b.ic())}function ye(e,t){if(1&e){const e=b.kc();b.jc(0,"input",46,47),b.uc("ngModelChange",(function(i){return b.Xc(e),t.row.rate=i}))("keyup",(function(i){b.Xc(e);const s=t.rowIndex;return b.yc().onKeyUp(i,s,2,"rate")}))("input",(function(){b.Xc(e);const i=t.rowIndex;return b.yc().calculateGstDiscountPercentage(i)})),b.ic(),b.hd(2,je,3,0,"div",35)}if(2&e){const e=t.row,i=t.rowIndex,s=b.Uc(1),r=b.yc();b.Jc("name","tableRate",i,""),b.Hc("ngModel",e.rate)("id","supplierList"+i+"-2")("ngClass",b.Nc(5,pe,r.formSubmitted&&s.invalid)),b.Pb(2),b.Hc("ngIf",r.formSubmitted&&s.invalid)}}function Se(e,t){if(1&e){const e=b.kc();b.jc(0,"input",48,49),b.uc("ngModelChange",(function(i){return b.Xc(e),t.row.discountedRate=i})),b.ic()}if(2&e){const e=t.row,i=t.rowIndex;b.Jc("name","tableDiscount",i,""),b.Hc("ngModel",e.discountedRate)("id","supplierList"+i+"-3")}}function Pe(e,t){if(1&e){const e=b.kc();b.jc(0,"input",48,50),b.uc("ngModelChange",(function(i){return b.Xc(e),t.row.gstRate=i})),b.ic()}if(2&e){const e=t.row,i=t.rowIndex;b.Jc("name","tableGst",i,""),b.Hc("ngModel",e.gstRate)("id","supplierList"+i+"-4")}}const Ie=function(){return{type:"zoom"}},ke=function(e){return{animation:e}};function we(e,t){if(1&e){const e=b.kc();b.jc(0,"nb-icon",51),b.uc("click",(function(){b.Xc(e);const i=t.rowIndex;return b.yc().removeItem(i)})),b.ic()}2&e&&b.Hc("options",b.Nc(2,ke,b.Mc(1,Ie)))}function Ce(e,t){if(1&e){const e=b.kc();b.jc(0,"input",52),b.uc("click",(function(t){b.Xc(e);const i=b.yc(),s=b.Uc(15);return i.addSupplierRateInfo(s),t.preventDefault()})),b.ic()}if(2&e){const e=b.yc();b.Hc("disabled",e.disableButton)}}function Re(e,t){if(1&e){const e=b.kc();b.jc(0,"button",53),b.uc("click",(function(){b.Xc(e);const t=b.yc(),i=b.Uc(15);return t.reset(i)})),b.jd(1,"CANCEL"),b.ic()}}const Ne=function(){return["/pages/supplier/view"]};function xe(e,t){1&e&&(b.jc(0,"button",54),b.jd(1,"CANCEL"),b.ic()),2&e&&b.Hc("routerLink",b.Mc(1,Ne))}function He(e,t){if(1&e){const e=b.kc();b.jc(0,"input",55),b.uc("click",(function(t){b.Xc(e);const i=b.yc(),s=b.Uc(15);return i.updateSupplierRateInfo(s),t.preventDefault()})),b.ic()}if(2&e){const e=b.yc();b.Hc("disabled",e.disableButton)}}let De=(()=>{class e{constructor(e,t,i,s,r,n){this.commonService=e,this.supplierService=t,this.router=i,this._route=s,this.toastr=r,this.modalService=n,this.errorData=d,this.duplicateFlag=!1,this.itemTypeData=["Color"],this.selectedType="Color",this.formSubmitted=!1,this.disableButton=!1,this.supplierListPdf=[],this.formValues={id:null,supplierName:null,gstPercentage:null,discountPercentage:null,remark:null,paymentTerms:null,createdBy:null,updatedBy:null,supplierId:null,supplierRates:[{itemType:"Color",supplierId:null,createdBy:null,updatedBy:null,userHeadId:null,itemName:null,rate:null,discountedRate:null,gstRate:null,id:null}]},this.flag=!1,this.module="supplier",this.headers=["Supplier Name","Item Name","Rate","Discount Rate","Rate with Gst"],this.destroy$=new a.a}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.getSupplierName(),this.getData(),null!=this.mySupplierRateId&&this.getUpdateData()}open(){this.flag=!0;const e=this.modalService.open(c.a);e.componentInstance.headers=this.headers,e.componentInstance.list=this.supplierListPdf,e.componentInstance.moduleName=this.module}getData(){this.user=this.commonService.getUser(),this.userHead=this.commonService.getUserHeadId(),this.mySupplierRateId=this._route.snapshot.paramMap.get("id")}getUpdateData(){this.supplierService.getAllSupplierById(this.mySupplierRateId).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{if(e.success){if(this.formValues=e.data,0==this.formValues.supplierRates.length){let e=this.formValues.supplierRates;e.push({id:null,supplierName:null,gstPercentage:null,discountPercentage:null,remark:null,createdBy:null,updatedBy:null,paymentTerms:null,userHeadId:null,supplierId:null,itemType:"Color",itemName:null,rate:null,discountedRate:null,gstRate:null}),this.formValues.supplierRates=[...e]}this.discount=this.formValues.discountPercentage,this.gst=this.formValues.gstPercentage,this.supplierListPdf=this.formValues.supplierRates.map(e=>({supplierName:this.formValues.supplierName,itemName:e.itemName,rate:e.rate,discountRate:e.discountedRate,gstRate:e.gstRate}))}},e=>{})}getSupplierName(){this.user=this.commonService.getUser(),this.supplierService.getSupplierNameV1().pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success&&(this.supplier=e.data)},e=>{})}addSupplierRateInfo(e){this.disableButton=!0,this.formSubmitted=!0,e.valid?(this.formValues.id=this.formValues.supplierRates[0].supplierId,delete this.formValues.discountPercentage,delete this.formValues.supplierName,delete this.formValues.supplierId,delete this.formValues.gstPercentage,delete this.formValues.remark,delete this.formValues.paymentTerms,delete this.formValues.updatedBy,this.formValues.supplierRates.forEach(e=>{e.createdBy=this.user.userId,e.userHeadId=this.userHead.userHeadId}),this.supplierService.addSupplierRateInSystem(this.formValues).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success?(this.router.navigate(["pages/supplier"]),this.toastr.success(e.msg)):this.toastr.error(e.msg),this.disableButton=!1},e=>{this.toastr.error(d.Serever_Error),this.disableButton=!1})):this.disableButton=!1}updateSupplierRateInfo(e){if(this.formSubmitted=!0,!e.valid)return this.toastr.error("Fill empty fields"),void(this.disableButton=!1);this.formValues.supplierId=this.formValues.supplierRates[0].supplierId,this.formValues.supplierId=this.formValues.id,this.formValues.supplierRates.forEach(e=>{e.updatedBy=this.user.userId,e.supplierId=this.formValues.supplierId}),this.formValues.updatedBy=this.user.userId,delete this.formValues.discountPercentage,delete this.formValues.supplierName,delete this.formValues.id,delete this.formValues.gstPercentage,delete this.formValues.remark,delete this.formValues.paymentTerms,delete this.formValues.createdBy,this.supplierService.updateSupplierRateInSystem(this.formValues).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{e.success?(this.router.navigate(["pages/supplier"]),this.toastr.success(e.msg)):this.toastr.error(e.msg),this.disableButton=!1},e=>{this.disableButton=!1,this.toastr.error(d.Serever_Error)})}reset(e){e.reset(),this.formSubmitted=!1}getDetail(e){this.formValues.supplierRates[0].supplierId=e;for(let t of this.supplier)t.id==e&&(this.discount=t.discountPercentage,this.gst=t.gstPercentage,this.formValues.supplierRates[0].discountedRate=this.discount,this.formValues.supplierRates[0].gstRate=this.gst)}checkDuplicateLocally(e,t){if(this.duplicateFlag=!1,this.hasDuplicates(this.formValues.supplierRates)){this.toastr.warning("Item Name exist in same Supplier");let e=this.formValues.supplierRates;e[t].itemName=null,e[t].rate=null,e[t].discountedRate=null,e[t].gstRate=null,this.formValues.supplierRates=[...e]}else this.supplierService.getDuplicateCheck(0,e.target.value).pipe(Object(n.a)(this.destroy$)).subscribe(e=>{if(e.data){this.toastr.warning("Item Name already exist");let i=this.formValues.supplierRates;i[t].itemName=null,i[t].rate=null,i[t].discountedRate=null,i[t].gstRate=null,this.formValues.supplierRates=[...i],this.duplicateFlag=e.data}},e=>{})}onKeyUp(e,t,i,s){if(13==(e.keyCode?e.keyCode:e.which))if(this.index="supplierList"+(t+1)+"-0",t===this.formValues.supplierRates.length-1){let e=this.formValues.supplierRates[t];if("itemName"==s){if(!e.itemName)return void this.toastr.error("Item name is required")}else if("itemType"==s){if(!e.itemType)return void this.toastr.error("Item type is required")}else if("rate"==s&&!e.rate)return void this.toastr.error("Rate is required");let i=this.formValues.supplierRates;i.push({id:null,supplierName:null,gstPercentage:null,discountPercentage:null,remark:null,createdBy:null,updatedBy:null,paymentTerms:null,userHeadId:null,supplierId:null,itemType:"Color",itemName:null,rate:null,discountedRate:null,gstRate:null}),this.formValues.supplierRates=[...i];let r=setInterval(()=>{let e=document.getElementById(this.index);null!=e&&(e.focus(),clearInterval(r))},10)}else{this.index="supplierList"+(t+1)+"-"+i;let e=setInterval(()=>{let t=document.getElementById(this.index);null!=t&&(t.focus(),clearInterval(e))},10)}}calculateGstDiscountPercentage(e){let t,i,s=Number(this.formValues.supplierRates[e].rate),r=Number(s*this.discount/100);t=Number(s-r);let n=Number(t*this.gst/100);i=Number(t+n),this.formValues.supplierRates[e].discountedRate=Number(parseFloat(t).toFixed(2)),this.formValues.supplierRates[e].gstRate=Number(parseFloat(i).toFixed(2))}removeItem(e){let t=this.formValues.supplierRates;1==this.formValues.supplierRates.length?(t[0].itemName=null,t[0].rate=null,t[0].discountedRate=null,t[0].gstRate=null,this.formValues.supplierRates=[...t]):(t.splice(e,1),this.formValues.supplierRates=[...t])}hasDuplicates(e){let t=[];e.forEach(e=>{t.push(e.itemName)});let i=t.slice().sort(),s=[];for(var r=0;r<i.length-1;r++)i[r+1]===i[r]&&s.push(i[r]);return s.length>0}}return e.\u0275fac=function(t){return new(t||e)(b.dc(o.a),b.dc(u.a),b.dc(r.c),b.dc(r.a),b.dc(z.b),b.dc(f.e))},e.\u0275cmp=b.Xb({type:e,selectors:[["ngx-add-edit-supplier-rate"]],decls:47,vars:24,consts:[[1,"nb-style"],[1,"nb-header"],[1,"row"],[1,"col-md-5","col-6","display-flex-start","max-width-device"],[1,"btn","btn-md","btn-design",3,"routerLink"],[1,"col-md-5","col-5"],[4,"ngIf","ngIfElse"],["updateS",""],[1,"col-md-2","col-1","display-flex-start","desktop-justify-flexend"],[1,"btn","btn-md","btn-design",3,"click"],["myForm","ngForm"],[1,"col-md-4"],[1,"form-group"],["class","form-group",4,"ngIf","ngIfElse"],["updateName",""],[1,"col-md-12"],[1,"material","common-table","datatable-auto-height",3,"rows","headerHeight","footerHeight"],["table",""],["name","itemName","prop","itemName",3,"sortable","width"],["ngx-datatable-cell-template",""],["name","itemType","prop","itemType",3,"sortable","width"],["name","Rate","prop","rate",3,"sortable","width"],["name","Discounted Rate","prop","discountedRate",3,"sortable","width"],["name","Rate With GST","prop","gstRate",3,"sortable","width"],["name","Action","sortable","false",3,"width"],[1,"col-md-12","mobile-btn-center","text-btn-right"],["type","button","class","btn btn-primary btn-sm btn-design","value","SAVE",3,"disabled","click",4,"ngIf","ngIfElse"],["type","button","class","btn btn-primary btn-sm btn-design",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-sm btn-design-cancel",3,"routerLink",4,"ngIf"],["updateadd",""],[1,"nb-text"],[1,"required"],["name","supplierId","id","supplierId","required","",3,"ngModel","ngClass","ngModelChange","change"],["tableitem3","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","input-required display-inlineblock",4,"ngIf"],[3,"value"],[1,"input-required","display-inlineblock"],["name","supplierId","required","",1,"form-control",3,"ngModel","ngModelChange"],["selected","","disabled","",3,"value"],["type","text","required","",1,"tableForm","line-height-subtable",3,"id","ngModel","name","ngClass","keyup","change","ngModelChange"],["tableitem","ngModel"],["required","","bindLabel","name","bindValue","id","appendTo","body",1,"ng-select-br-none",3,"name","ngModel","id","ngClass","ngModelChange"],["tableItemType","ngModel"],["selected","","value","Color"],["value","Chemical"],["type","number","onkeypress","return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57  || event.charCode == 46","required","","min","0",1,"tableForm","line-height-subtable",3,"name","ngModel","id","ngClass","ngModelChange","keyup","input"],["tableRate1","ngModel"],["type","number","readonly","",1,"tableForm","line-height-subtable",3,"name","ngModel","id","ngModelChange"],["tablediscount1","ngModel"],["tableGst1","ngModel"],["icon","trash","status","danger",3,"options","click"],["type","button","value","SAVE",1,"btn","btn-primary","btn-sm","btn-design",3,"disabled","click"],["type","button",1,"btn","btn-primary","btn-sm","btn-design",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-cancel",3,"routerLink"],["type","button","value","UPDATE",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"disabled","click"]],template:function(e,t){if(1&e&&(b.jc(0,"nb-card",0),b.jc(1,"nb-card-header",1),b.jc(2,"div",2),b.jc(3,"div",3),b.jc(4,"button",4),b.jd(5,"View Table"),b.ic(),b.ic(),b.jc(6,"div",5),b.hd(7,le,3,0,"div",6),b.hd(8,de,2,0,"ng-template",null,7,b.id),b.ic(),b.jc(10,"div",8),b.jc(11,"button",9),b.uc("click",(function(){return t.open()})),b.jd(12,"EXPORT"),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(13,"nb-card-body"),b.jc(14,"form",null,10),b.jc(16,"div",2),b.jc(17,"div",11),b.jc(18,"div",12),b.hd(19,he,7,6,"div",13),b.hd(20,me,6,3,"ng-template",null,14,b.id),b.ic(),b.ic(),b.ic(),b.ec(22,"br"),b.ec(23,"br"),b.jc(24,"div",2),b.jc(25,"div",15),b.jc(26,"ngx-datatable",16,17),b.jc(28,"ngx-datatable-column",18),b.hd(29,be,3,7,"ng-template",19),b.ic(),b.jc(30,"ngx-datatable-column",20),b.hd(31,ve,7,7,"ng-template",19),b.ic(),b.jc(32,"ngx-datatable-column",21),b.hd(33,ye,3,7,"ng-template",19),b.ic(),b.jc(34,"ngx-datatable-column",22),b.hd(35,Se,2,3,"ng-template",19),b.ic(),b.jc(36,"ngx-datatable-column",23),b.hd(37,Pe,2,3,"ng-template",19),b.ic(),b.jc(38,"ngx-datatable-column",24),b.hd(39,we,1,4,"ng-template",19),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(40,"div",2),b.jc(41,"div",25),b.hd(42,Ce,1,1,"input",26),b.hd(43,Re,2,0,"button",27),b.hd(44,xe,2,2,"button",28),b.hd(45,He,1,1,"ng-template",null,29,b.id),b.ic(),b.ic(),b.ic(),b.ic(),b.ic()),2&e){const e=b.Uc(9),i=b.Uc(21),s=b.Uc(46);b.Pb(4),b.Hc("routerLink",b.Mc(23,Ne)),b.Pb(3),b.Hc("ngIf",null==t.mySupplierRateId)("ngIfElse",e),b.Pb(12),b.Hc("ngIf",null==t.mySupplierRateId)("ngIfElse",i),b.Pb(7),b.Hc("rows",t.formValues.supplierRates)("headerHeight",31)("footerHeight",31),b.Pb(2),b.Hc("sortable",!1)("width",300),b.Pb(2),b.Hc("sortable",!1)("width",300),b.Pb(2),b.Hc("sortable",!1)("width",300),b.Pb(2),b.Hc("sortable",!1)("width",300),b.Pb(2),b.Hc("sortable",!1)("width",300),b.Pb(2),b.Hc("width",90),b.Pb(4),b.Hc("ngIf",!t.mySupplierRateId)("ngIfElse",s),b.Pb(1),b.Hc("ngIf",!t.mySupplierRateId),b.Pb(1),b.Hc("ngIf",t.mySupplierRateId)}},directives:[h.u,h.x,r.d,s.n,h.t,j.x,j.m,j.n,y.e,y.b,y.a,S.a,j.t,j.l,j.o,s.l,s.m,S.c,j.u,j.p,j.w,j.a,j.q,h.I],styles:['.required[_ngcontent-%COMP%]:after{content:" *";color:red}.tableForm[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #000}.required-class[_ngcontent-%COMP%]{display:contents!important;width:100%;margin-top:.25rem;font-size:80%;color:#dc3545}']}),e})();var Te=i("RWgp"),Ee=i("lvCO");let Ve=(()=>{class e{constructor(e,t,i,s,r){this.commonService=e,this.jwtToken=t,this.storeTokenService=i,this.toastr=s,this._router=r,this.errorData=d}canActivate(e,t){this.jwtToken.setToken(this.storeTokenService.get("token"));var i=this.jwtToken.getDecodeToken("supplierRate");this.permis=this.commonService.decToBin(i);let s=e.data.PermissionName;if(1==s.length)switch(s[0]){case"view":return"1"==this.permis[0]||(this._router.navigate(["/pages"]),!1);case"add":return"1"==this.permis[1]||(this._router.navigate(["/pages/color/view"]),!1);case"edit":return"1"==this.permis[2]||(this._router.navigate(["/pages"]),!1);case"delete":return"1"==this.permis[3]||(this._router.navigate(["/pages"]),!1);case"view group":return"1"==this.permis[4]||(this._router.navigate(["/pages"]),!1);case"edit group":return"1"==this.permis[5]||(this._router.navigate(["/pages"]),!1);case"delete group":return"1"==this.permis[6]||(this._router.navigate(["/pages"]),!1);case"view all":return"1"==this.permis[7]||(this._router.navigate(["/pages"]),!1);case"edit all":return"1"==this.permis[8]||(this._router.navigate(["/pages"]),!1);case"delete all":return"1"==this.permis[9]||(this._router.navigate(["/pages"]),!1)}else if(3==s.length)return"1"==this.permis[0]||"1"==this.permis[4]||"1"==this.permis[7]||(this._router.navigate(["/pages"]),!1)}canLoad(e,t){this.jwtToken.setToken(this.storeTokenService.get("token"));var i=this.jwtToken.getDecodeToken("supplierRate");let s=this.commonService.decToBin(i);return"1"==s[0]||"1"==s[4]||"1"==s[7]||(this.toastr.error(d.NoPermission),!1)}accessRights(e){this.jwtToken.setToken(this.storeTokenService.get("token"));var t=this.jwtToken.getDecodeToken("supplierRate");switch(this.permis=this.commonService.decToBin(t),e){case"view":return"1"==this.permis[0];case"add":return"1"==this.permis[1];case"edit":return"1"==this.permis[2];case"delete":return"1"==this.permis[3];case"view group":return"1"==this.permis[4];case"edit group":return"1"==this.permis[5];case"delete group":return"1"==this.permis[6];case"view all":return"1"==this.permis[7];case"edit all":return"1"==this.permis[8];case"delete all":return"1"==this.permis[9]}}}return e.\u0275fac=function(t){return new(t||e)(b.rc(o.a),b.rc(Te.a),b.rc(Ee.a),b.rc(z.b),b.rc(r.c))},e.\u0275prov=b.Zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const qe=[{path:"",component:ce,canActivate:[l.a],canLoad:[l.a],data:{PermissionName:["add"]}},{path:"view",component:X,canActivate:[l.a],canLoad:[l.a],data:{PermissionName:["view","view group","view all"]}},{path:"addSupplierRate",component:De,canActivate:[Ve],canLoad:[Ve],data:{PermissionName:["add"]}},{path:"editSupplierRate/:id",component:De,canActivate:[Ve],canLoad:[Ve],data:{PermissionName:["edit","edit group","edit all"]}},{path:"edit/:id",component:ce,canActivate:[l.a],canLoad:[l.a],data:{PermissionName:["edit","edit group","edit all"]}}];let Me=(()=>{class e{}return e.\u0275mod=b.bc({type:e}),e.\u0275inj=b.ac({factory:function(t){return new(t||e)},providers:[l.a],imports:[[r.g.forChild(qe)],r.g]}),e})();var Le=i("yzeJ"),Ae=i("vTDv");let Fe=(()=>{class e{}return e.\u0275mod=b.bc({type:e}),e.\u0275inj=b.ac({factory:function(t){return new(t||e)},imports:[[s.c,Le.a,Me,j.s,Ae.a]]}),e})()}}]);