(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{tJF0:function(e,t,i){"use strict";i.r(t),i.d(t,"SalesReportModule",(function(){return $}));var c=i("ofXK"),o=i("yzeJ"),r=i("tyNb"),a=i("rj63"),s=i("mrSG"),n=i("tcrU"),d=i("LvDl"),l=i("wd/R"),p=i("XNiG"),u=i("1G5W"),h=i("v1rY"),m=i("8tQ5"),g=i("bidh"),v=i("cmeu"),j=i("tA+f"),y=i("8k+d"),b=i("RNo3"),R=i("IYph"),f=i("fXoL"),q=i("5eHb"),M=i("aceb"),P=i("3Pt+"),S=i("ZOsW"),L=i("z17N");function w(e,t){if(1&e&&(f.jc(0,"ng-option",32),f.jd(1),f.ic()),2&e){const e=t.$implicit;f.Hc("value",e),f.Pb(1),f.ld("",e.name," ")}}function N(e,t){1&e&&(f.jc(0,"div",33),f.jc(1,"span"),f.jd(2,"From date is required."),f.ic(),f.ic())}function I(e,t){1&e&&(f.jc(0,"div",33),f.jc(1,"span"),f.jd(2,"To date is required."),f.ic(),f.ic())}function D(e,t){if(1&e&&(f.jc(0,"ng-option",32),f.jc(1,"div",1),f.jc(2,"div",22),f.jc(3,"div",23),f.jd(4),f.ic(),f.ic(),f.jc(5,"div",22),f.jc(6,"div",24),f.jd(7),f.ic(),f.ic(),f.ic(),f.ic()),2&e){const e=t.$implicit;f.Hc("value",e.id),f.Pb(4),f.ld(" ",e.partyName," "),f.Pb(3),f.ld(" ",e.partyCode," ")}}function T(e,t){if(1&e&&(f.jc(0,"ng-option",32),f.jc(1,"div",1),f.jc(2,"div",22),f.jc(3,"div",23),f.jd(4),f.ic(),f.ic(),f.jc(5,"div",22),f.jc(6,"div",24),f.jd(7),f.ic(),f.ic(),f.ic(),f.ic()),2&e){const e=t.$implicit;f.Hc("value",e.qualityEntryId),f.Pb(4),f.ld(" ",e.qualityId," "),f.Pb(3),f.ld(" ",e.partyName," ")}}function x(e,t){if(1&e&&(f.jc(0,"ng-option",32),f.jd(1),f.ic()),2&e){const e=t.$implicit;f.Hc("value",e.id),f.Pb(1),f.kd(e.userName)}}function F(e,t){if(1&e&&(f.jc(0,"ng-option",32),f.jc(1,"div",1),f.jc(2,"div",22),f.jc(3,"div",23),f.jd(4),f.ic(),f.ic(),f.ic(),f.ic()),2&e){const e=t.$implicit;f.Hc("value",e.id),f.Pb(4),f.ld(" ",e.qualityName,"")}}const H=function(e){return{"is-invalid":e}},C=[{path:"",component:(()=>{class e{constructor(e,t,i,c,o,r,a,s,n){this.invoiceService=e,this.partyService=t,this.qualityService=i,this.shadeService=c,this.adminService=o,this.exportService=r,this.reportService=a,this.datepipe=s,this.toaster=n,this.currentDate=new Date,this.disableButton=!1,this.masterList=[],this.partyList=[],this.qualityNameList=[],this.shortReport=[],this.reportType=null,this.destroy$=new p.a,this.formSubmitted=!1,this.reportList=[{name:"Sales Report",value:"salesReport"},{name:"Sales Pending Report",value:"salesPendingReport"}],this.apiObject={reportId:"",apiForExcel:"",apiForReport:""},this.invoiceReportRequest=new m.b}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.getReportList(),this.maxDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),this.currentDate.getDate(),23,59),this.getAllMasters(),this.getAllParties(),this.getQualityList(),this.getQualityNameList()}getReportList(){this.reportService.getAllReportType("sales").pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success&&(this.reportList=e.data)},e=>{})}getQualityNameList(){this.adminService.getAllQualityData().pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success&&(this.qualityNameList=e.data)},e=>{})}getAllMasters(){this.partyService.getAllMaster().pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success&&(this.masterList=e.data)},e=>{})}getAllParties(){this.partyService.getAllPartyList(0,"all").pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success&&(this.partyList=e.data)},e=>{})}getQualityList(){return Object(s.a)(this,void 0,void 0,(function*(){return yield new Promise((e,t)=>{this.qualityService.getQualityNameData().pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success&&(this.qualityList=e.data||[],this.qualityList&&this.qualityList.length&&this.qualityList.forEach(e=>{e.qualityEntryId=e.id}))},e=>{})})}))}getQualityFromParty(e){this.shadeService.getQualityFromParty(this.invoiceReportRequest.partyId).pipe(Object(u.a)(this.destroy$)).subscribe(e=>{e.success?(this.qualityList=e.data.qualityDataList,this.qualityList.forEach(t=>{t.partyName=e.data.partyName})):this.qualityList=null},e=>{})}getShortReport(e){this.totalAmount=0,this.totalFinishedMeter=0,this.totalGrayMeter=0,this.shortReport=[],this.formSubmitted=!0,e.valid&&(this.invoiceReportRequest.from=l(this.invoiceReportRequest.from).format(),this.invoiceReportRequest.to=l(this.invoiceReportRequest.to).format(),this.invoiceService.getShortInvoiceReport(this.invoiceReportRequest).pipe(Object(u.a)(this.destroy$)).subscribe(t=>{if(t.success&&(this.shortReport=t.data,this.shortReport&&this.shortReport.length)){if(this.shortReport[0].consolidatedBillDataList&&this.shortReport[0].consolidatedBillDataList.length){let e=/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g,t=Object.keys(this.shortReport[0].consolidatedBillDataList[0]),i=[];t.forEach((t,c)=>{i.push(t.replace(e,"$1$4 $2$3$5")),i[c]=i[c].charAt(0).toUpperCase()+i[c].slice(1)}),this.headers=[...i],this.shortReport.forEach(e=>{e.consolidatedBillDataList.forEach(e=>{this.totalFinishedMeter+=e.totalFinishMtr,this.totalGrayMeter+=e.totalMtr,this.totalAmount+=e.taxAmt})})}this.shortReport=Object(d.sortBy)(this.shortReport,"invoiceNo"),this.printReport(e)}},e=>{}))}printReport(e){let t=new n.PrintDocument({title:""});t.append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.3.0/paper.css">'),t.append('<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">'),t.append('<link href="https://cdn.grapecity.com/wijmo/5.latest/styles/wijmo.min.css" rel="stylesheet">');let i=setInterval(()=>{let e=document.getElementById("shortReport");null!=e&&(t.append(e),clearInterval(i),setTimeout(()=>{t.print(),this.shortReport=[],this.invoiceReportRequest=new m.b,this.formSubmitted=!1},1e3))},10)}downLoadExcel(e){this.formSubmitted=!0,this.reportType?e.valid&&(this.invoiceReportRequest.from&&(this.invoiceReportRequest.from=l(this.invoiceReportRequest.from).format()),this.invoiceReportRequest.to&&(this.invoiceReportRequest.to=l(this.invoiceReportRequest.to).format()),this.invoiceService.getShortInvoiceReport(this.invoiceReportRequest).pipe(Object(u.a)(this.destroy$)).subscribe(e=>{if(e.success){let t=e.data;this.headers=Object.keys(t),this.formSubmitted=!1,this.headers.forEach(e=>{e.replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()}))}),this.exportService.exportExcel(t,"Sales Report",this.headers)}},e=>{})):(this.toaster.error("Select Report Type"),this.formSubmitted=!1)}selectedReport(e){this.apiObject={reportId:"",apiForExcel:"",apiForReport:""},this.apiObject.reportId=e.id,this.apiObject.apiForExcel=e.urlForExcel,this.apiObject.apiForReport=e.urlForReport,this.invoiceReportRequest.reportType=e.id}}return e.\u0275fac=function(t){return new(t||e)(f.dc(j.a),f.dc(y.a),f.dc(b.a),f.dc(R.a),f.dc(g.a),f.dc(v.a),f.dc(h.a),f.dc(c.e),f.dc(q.b))},e.\u0275cmp=f.Xb({type:e,selectors:[["ngx-sales-report"]],decls:87,vars:30,consts:[[1,"nb-header"],[1,"row"],[1,"col-md-10","col-6"],[1,"nb-text"],["invoiceForm","ngForm"],[1,"form-group","col-md-4"],[1,"required"],["name","report","appendTo","body","id","report","placeholder","Select Report",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"form-group"],["required","","name","fromDate","placeholder","Select Date",1,"form-control",3,"max","ngModel","owlDateTimeTrigger","owlDateTime","ngClass","ngModelChange"],["from","ngModel"],[3,"pickerType","afterPickerClosed"],["dtFrom1",""],["class","input-required",4,"ngIf"],["required","","name","toDate","placeholder","Select Date",1,"form-control",3,"max","disabled","ngModel","owlDateTimeTrigger","owlDateTime","min","ngClass","ngModelChange"],["to","ngModel"],["dtTo1",""],["appendTo","body","placeholder","Select Party Name","name","partyName","partyName1","ngModel",3,"ngModel","ngModelChange","change"],["partyName1","ngModel"],["disabled","true"],[1,"col-md-6","col-6"],[1,"text-left","txt-ov-elips"],[1,"text-right","txt-ov-elips"],["appendTo","body","placeholder","Select Quality Id","name","qualityId",3,"ngModel","ngModelChange"],["qualityId1","ngModel"],["name","userHeadId","appendTo","body","id","userHeadId","name","userHeadId","placeholder","Select Master",3,"ngModel","ngModelChange"],["name","qualityName","appendTo","body","id","qualityName","placeholder","Quality Name",3,"ngModel","ngModelChange"],[1,"col-md-6","mobile-btn-center","text-btn-right"],[1,"padding-bt-tp"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"click"],[3,"value"],[1,"input-required"]],template:function(e,t){if(1&e){const e=f.kc();f.jc(0,"nb-card"),f.jc(1,"nb-card-header",0),f.jc(2,"div",1),f.jc(3,"div",2),f.jc(4,"h2",3),f.jd(5,"Sales Report"),f.ic(),f.ic(),f.ic(),f.ic(),f.jc(6,"nb-card-body"),f.jc(7,"form",null,4),f.jc(9,"div",1),f.jc(10,"div",5),f.jc(11,"label",6),f.jd(12,"Report Type"),f.ic(),f.jc(13,"ng-select",7),f.uc("ngModelChange",(function(e){return t.reportType=e}))("change",(function(e){return t.selectedReport(e)})),f.jc(14,"div"),f.hd(15,w,2,2,"ng-option",8),f.ic(),f.ic(),f.ic(),f.ic(),f.jc(16,"div",1),f.jc(17,"div",9),f.jc(18,"div",10),f.jc(19,"label",6),f.jd(20,"From date"),f.ic(),f.jc(21,"input",11,12),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.from=e})),f.ic(),f.jc(23,"owl-date-time",13,14),f.uc("afterPickerClosed",(function(){return null})),f.ic(),f.ic(),f.hd(25,N,3,0,"div",15),f.ic(),f.jc(26,"div",9),f.jc(27,"div",10),f.jc(28,"label",6),f.jd(29,"To date"),f.ic(),f.jc(30,"input",16,17),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.to=e})),f.ic(),f.jc(32,"owl-date-time",13,18),f.uc("afterPickerClosed",(function(){return null})),f.ic(),f.ic(),f.hd(34,I,3,0,"div",15),f.ic(),f.jc(35,"div",9),f.jc(36,"div",10),f.jc(37,"label"),f.jd(38,"Party Name"),f.ic(),f.jc(39,"ng-select",19,20),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.partyId=e}))("change",(function(e){return t.getQualityFromParty(e)})),f.jc(41,"ng-option",21),f.jc(42,"div",1),f.jc(43,"div",22),f.jc(44,"div",23),f.jd(45," Party Name "),f.ic(),f.ic(),f.jc(46,"div",22),f.jc(47,"div",24),f.jd(48," Party Code "),f.ic(),f.ic(),f.ic(),f.ic(),f.hd(49,D,8,3,"ng-option",8),f.ic(),f.ic(),f.ic(),f.ic(),f.jc(50,"div",1),f.jc(51,"div",9),f.jc(52,"div",10),f.jc(53,"label"),f.jd(54,"Quality Id"),f.ic(),f.jc(55,"ng-select",25,26),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.qualityEntryId=e})),f.jc(57,"ng-option",21),f.jc(58,"div",1),f.jc(59,"div",22),f.jc(60,"div",23),f.jd(61," Quality Id "),f.ic(),f.ic(),f.jc(62,"div",22),f.jc(63,"div",24),f.jd(64," Party Name "),f.ic(),f.ic(),f.ic(),f.ic(),f.hd(65,T,8,3,"ng-option",8),f.ic(),f.ic(),f.ic(),f.jc(66,"div",5),f.jc(67,"label"),f.jd(68,"Master Name"),f.ic(),f.jc(69,"ng-select",27),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.userHeadId=e})),f.jc(70,"div"),f.hd(71,x,2,2,"ng-option",8),f.ic(),f.ic(),f.ic(),f.jc(72,"div",5),f.jc(73,"label"),f.jd(74,"Quality Name"),f.ic(),f.jc(75,"ng-select",28),f.uc("ngModelChange",(function(e){return t.invoiceReportRequest.qualityNameId=e})),f.jc(76,"ng-option",21),f.jc(77,"div",1),f.jc(78,"div",22),f.jc(79,"div",23),f.jd(80,"Quality Name "),f.ic(),f.ic(),f.ic(),f.ic(),f.hd(81,F,5,2,"ng-option",8),f.ic(),f.ic(),f.ic(),f.jc(82,"div",1),f.jc(83,"div",29),f.jc(84,"div",30),f.jc(85,"button",31),f.uc("click",(function(){f.Xc(e);const i=f.Uc(8);return t.downLoadExcel(i)})),f.jd(86,"Get Excel"),f.ic(),f.ic(),f.ic(),f.ic(),f.ic(),f.ic(),f.ic()}if(2&e){const e=f.Uc(22),i=f.Uc(24),c=f.Uc(31),o=f.Uc(33);f.Pb(13),f.Hc("ngModel",t.reportType),f.Pb(2),f.Hc("ngForOf",t.reportList),f.Pb(6),f.Hc("max",t.maxDate)("ngModel",t.invoiceReportRequest.from)("owlDateTimeTrigger",i)("owlDateTime",i)("ngClass",f.Nc(26,H,e.invalid&&(t.formSubmitted||e.touched))),f.Pb(2),f.Hc("pickerType","calendar"),f.Pb(2),f.Hc("ngIf",e.invalid&&(t.formSubmitted||e.touched)),f.Pb(5),f.Hc("max",t.maxDate)("disabled",!t.invoiceReportRequest.from)("ngModel",t.invoiceReportRequest.to)("owlDateTimeTrigger",o)("owlDateTime",o)("min",t.invoiceReportRequest.from)("ngClass",f.Nc(28,H,c.invalid&&(t.formSubmitted||c.touched))),f.Pb(2),f.Hc("pickerType","calendar"),f.Pb(2),f.Hc("ngIf",c.invalid&&(t.formSubmitted||c.touched)),f.Pb(5),f.Hc("ngModel",t.invoiceReportRequest.partyId),f.Pb(10),f.Hc("ngForOf",t.partyList),f.Pb(6),f.Hc("ngModel",t.invoiceReportRequest.qualityEntryId),f.Pb(10),f.Hc("ngForOf",t.qualityList),f.Pb(4),f.Hc("ngModel",t.invoiceReportRequest.userHeadId),f.Pb(2),f.Hc("ngForOf",t.masterList),f.Pb(4),f.Hc("ngModel",t.invoiceReportRequest.qualityNameId),f.Pb(6),f.Hc("ngForOf",t.qualityNameList)}},directives:[M.u,M.x,M.t,P.x,P.m,P.n,S.a,P.l,P.o,c.m,P.a,L.c,P.t,L.e,c.l,L.b,c.n,S.c],styles:[""]}),e})(),canActivate:[a.a],canLoad:[a.a],data:{PermissionName:["view","view group","view all"]}}];let O=(()=>{class e{}return e.\u0275mod=f.bc({type:e}),e.\u0275inj=f.ac({factory:function(t){return new(t||e)},imports:[[r.g.forChild(C)],r.g]}),e})(),$=(()=>{class e{}return e.\u0275mod=f.bc({type:e}),e.\u0275inj=f.ac({factory:function(t){return new(t||e)},imports:[[c.c,o.a,O]]}),e})()}}]);