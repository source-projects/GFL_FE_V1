(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{R0b5:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var c=i("4/8P"),n=i("fXoL"),a=i("tk/3");let r=(()=>{class t{constructor(t,e){this.httpClient=t,this.commonService=e}saveMergedBatch(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/create/mergeBatchList",t)}getBatchesByPartyQuality(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/ByQualityAndPartyWithoutProductionPlan/"+t+"/"+e)}getAllMergeBatch(){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/get/mergeBatchList")}getAllMergeBatchV1(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/get/mergeBatchList/allPaginated",t)}getMergeBatchById(t){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/get/mergeBatchListBy?mergeBatchId="+t)}deleteMergeBatch(t){return this.httpClient.delete(this.commonService.envUrl()+"api/stockBatch/delete/mergeBatchListBy?mergeBatchId="+t)}updateMergeBatch(t){return this.httpClient.put(this.commonService.envUrl()+"api/stockBatch/update/mergeBatchList",t)}}return t.\u0275fac=function(e){return new(e||t)(n.rc(a.b),n.rc(c.a))},t.\u0275prov=n.Zb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},SapW:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var c=i("4/8P"),n=i("fXoL"),a=i("tk/3");let r=(()=>{class t{constructor(t,e){this.httpClient=t,this.commonService=e}isBatchIdExists(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/isBatchExists/"+t+"/"+e)}isPchallanExists(t,e){return this.httpClient.get(this.commonService.envUrl()+`api/stockBatch/exist/pchallan?partyId=${t}&pchallanRef=${e}`)}addPchallan(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/add/pchallan",t)}updatePchallan(t){return this.httpClient.put(this.commonService.envUrl()+"api/stockBatch/update/pchallan",t)}deleteStockBatchById(t){return this.httpClient.delete(this.commonService.envUrl()+"api/stockBatch/"+t)}getAllStockBatchList(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/all/"+e+"/"+t)}getAllStockBatchList1(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/allpaginated",t)}getAvailableStockBatchList(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/pending/all/"+e+"/"+t)}getShortStockReport(t){return this.httpClient.post(this.commonService.envUrl()+"api/dispatch/report/forConslidateBill",t)}getDetailedStockReport(t){return this.httpClient.post(this.commonService.envUrl()+"api/dispatch/filter/getBill",t)}addStockBatch(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch",t)}updateStockBatch(t){return this.httpClient.put(this.commonService.envUrl()+"api/stockBatch",t)}getStockBatchById(t){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/"+t)}getAllBatch(){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/all")}getBatchById(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/ByQualityAndParty/"+e+"/"+t)}getAllBatchForAdditionSlip(){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/forAdditionalSlip")}getJobCardData(t){return this.httpClient.get(`${this.commonService.envUrl()}api/stockBatch/get/getJobCardBy?batchId=${t}`)}getBatchSequence(t){return this.httpClient.get(this.commonService.envUrl()+"api/admin/get/batchSequence?update="+t)}updateBatchSequence(t){return this.httpClient.put(this.commonService.envUrl()+"api/admin/update/batchSequence/",t)}getBatchesByPartyQuality(t,e){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/ByQualityAndPartyWithProductionPlan/"+t+"/"+e)}getBatchGRById(t){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/batch/"+t+"/"+t)}returnLotPost(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/add/returnBatch",t)}returnLotgetById(t){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/get/returnBatch?chlNo="+t)}returnLotgetAll(){return this.httpClient.get(this.commonService.envUrl()+"api/stockBatch/all/returnBatch")}returnLotgetAllPaginated(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/all/returnBatch/allPaginated",t)}getConslidateBatchResponse(t){return this.httpClient.post(this.commonService.envUrl()+"api/stockBatch/pending/forConslidateBatchResponse",t)}}return t.\u0275fac=function(e){return new(e||t)(n.rc(a.b),n.rc(c.a))},t.\u0275prov=n.Zb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},vbAA:function(t,e,i){"use strict";i.r(e),i.d(e,"MergeBatchModule",(function(){return mt}));var c=i("ofXK"),n=i("lDzL"),a=i("3Pt+"),r=i("tyNb"),s=i("p9GR"),o=i("mrSG"),d=i("1G5W"),l=i("XNiG"),h=i("5+WD"),p=i("8k+d");class u{constructor(){this.ckdId="ckList"}}var g=i("RNo3"),b=i("SapW"),m=i("R0b5"),f=i("4/8P"),v=i("fXoL"),y=i("5eHb"),j=i("aceb"),B=i("ZOsW"),I=i("7v3O");function S(t,e){if(1&t&&(v.jc(0,"ng-option",37),v.jc(1,"div",0),v.jc(2,"div",32),v.jc(3,"div",33),v.jd(4),v.ic(),v.ic(),v.jc(5,"div",32),v.jc(6,"div",34),v.jd(7),v.ic(),v.ic(),v.ic(),v.ic()),2&t){const t=e.$implicit;v.Hc("value",t.id),v.Pb(4),v.ld(" ",t.partyName," "),v.Pb(3),v.ld(" ",t.partyCode," ")}}function k(t,e){if(1&t&&(v.jc(0,"ng-option",37),v.jc(1,"div",0),v.jc(2,"div",32),v.jc(3,"div",33),v.jd(4),v.ic(),v.ic(),v.jc(5,"div",32),v.jc(6,"div",34),v.jd(7),v.ic(),v.ic(),v.ic(),v.ic()),2&t){const t=e.$implicit;v.Hc("value",t.qualityEntryId),v.Pb(4),v.ld(" ",t.qualityId," "),v.Pb(3),v.ld(" ",t.partyName," ")}}function x(t,e){if(1&t){const t=v.kc();v.jc(0,"div",0),v.jc(1,"div",38),v.jc(2,"div",39),v.jc(3,"label",28),v.jd(4,"Quality"),v.ic(),v.jc(5,"ng-select",40,41),v.uc("ngModelChange",(function(e){return v.Xc(t),v.yc().$implicit.qualityId=e}))("change",(function(e){v.Xc(t);const i=v.yc().index;return v.yc().qualitySelected(e,i)})),v.jc(7,"ng-option",31),v.jc(8,"div",0),v.jc(9,"div",32),v.jc(10,"div",33),v.jd(11," Quality ID "),v.ic(),v.ic(),v.jc(12,"div",32),v.jc(13,"div",34),v.jd(14," Party Name "),v.ic(),v.ic(),v.ic(),v.ic(),v.hd(15,k,8,3,"ng-option",35),v.ic(),v.ic(),v.ic(),v.ic()}if(2&t){const t=v.yc(),e=t.index,i=t.$implicit,c=v.yc();v.Pb(5),v.Jc("name","qualityId",e,""),v.Hc("ngModel",i.qualityId)("disabled",c.disable),v.Pb(10),v.Hc("ngForOf",i.qualityList)}}function P(t,e){if(1&t&&(v.jc(0,"ng-option",37),v.jd(1),v.ic()),2&t){const t=e.$implicit;v.Hc("value",t.batchId),v.Pb(1),v.ld(" ",t.batchId," ")}}function C(t,e){if(1&t){const t=v.kc();v.jc(0,"div",0),v.jc(1,"div",38),v.jc(2,"div",42),v.jc(3,"label",28),v.jd(4,"Batch"),v.ic(),v.jc(5,"ng-select",43,44),v.uc("ngModelChange",(function(e){return v.Xc(t),v.yc().$implicit.batchId=e}))("change",(function(e){v.Xc(t);const i=v.yc().index;return v.yc().batchSelected(e,i)})),v.jc(7,"ng-option",31),v.jc(8,"div",0),v.jc(9,"div",19),v.jc(10,"div",33),v.jd(11," Batch ID "),v.ic(),v.ic(),v.ic(),v.ic(),v.hd(12,P,2,2,"ng-option",35),v.zc(13,"filterselectedBatches"),v.ic(),v.ic(),v.ic(),v.ic()}if(2&t){const t=v.yc(),e=t.index,i=t.$implicit,c=v.yc();v.Pb(5),v.Jc("name","batchId",e,""),v.Hc("ngModel",i.batchId)("disabled",c.disable),v.Pb(7),v.Hc("ngForOf",v.Dc(13,4,i.batchList,c.filterDetails,e,c.refreshCount))}}function D(t,e){if(1&t&&(v.jc(0,"div",49),v.jc(1,"div",50),v.jd(2),v.ic(),v.ic()),2&t){const t=e.$implicit;v.Pb(2),v.md(" Meter: ",t.mtr," Weight: ",t.wt," ")}}const M=function(t){return[t]};function L(t,e){if(1&t){const t=v.kc();v.jc(0,"div",0),v.jc(1,"div",38),v.jc(2,"div",45),v.jc(3,"span"),v.jc(4,"h2",16),v.jd(5," Batch List "),v.jc(6,"span"),v.jc(7,"button",46),v.uc("click",(function(){v.Xc(t);const e=v.yc().$implicit;return v.yc().addAllGrInMergeBatch(e.batchId)})),v.jd(8,"Add"),v.ic(),v.ic(),v.ic(),v.ic(),v.jc(9,"div",17),v.uc("cdkDropListDropped",(function(e){return v.Xc(t),v.yc(2).drop(e)})),v.jc(10,"div",0),v.jc(11,"div",19),v.jc(12,"div",47),v.hd(13,D,3,2,"div",48),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic()}if(2&t){const t=v.yc(),e=t.$implicit,i=t.index;v.yc();const c=v.Uc(28);v.Pb(9),v.Hc("cdkDropListData",e.grList)("cdkDropListConnectedTo",v.Nc(4,M,c)),v.Qb("id",i),v.Pb(4),v.Hc("ngForOf",e.grList)}}function w(t,e){if(1&t){const t=v.kc();v.jc(0,"div",26),v.jc(1,"div",27),v.jc(2,"label",28),v.jd(3,"Party"),v.ic(),v.jc(4,"ng-select",29,30),v.uc("ngModelChange",(function(i){return v.Xc(t),e.$implicit.partyId=i}))("change",(function(i){v.Xc(t);const c=e.index;return v.yc().partySelected(i,c)})),v.jc(6,"ng-option",31),v.jc(7,"div",0),v.jc(8,"div",32),v.jc(9,"div",33),v.jd(10,"Party Name"),v.ic(),v.ic(),v.jc(11,"div",32),v.jc(12,"div",34),v.jd(13," Party Code "),v.ic(),v.ic(),v.ic(),v.ic(),v.hd(14,S,8,3,"ng-option",35),v.ic(),v.ic(),v.hd(15,x,16,4,"div",36),v.hd(16,C,14,9,"div",36),v.hd(17,L,14,6,"div",36),v.ic()}if(2&t){const t=e.$implicit,i=e.index,c=v.yc();v.Pb(4),v.Jc("name","partyId",i,""),v.Hc("ngModel",t.partyId)("disabled",c.disable),v.Pb(10),v.Hc("ngForOf",c.partyList),v.Pb(1),v.Hc("ngIf",t.partyId),v.Pb(1),v.Hc("ngIf",t.qualityId),v.Pb(1),v.Hc("ngIf",t.batchId)}}const q=function(){return{type:"zoom"}},H=function(t){return{animation:t}};function F(t,e){if(1&t){const t=v.kc();v.jc(0,"div",51),v.jc(1,"nb-icon",52),v.uc("click",(function(){return v.Xc(t),v.yc().addRemoveThirdFilterDetail(!0)})),v.ic(),v.ic()}2&t&&(v.Pb(1),v.Hc("options",v.Nc(2,H,v.Mc(1,q))))}function A(t,e){if(1&t){const t=v.kc();v.jc(0,"div",51),v.jc(1,"nb-icon",53),v.uc("click",(function(){return v.Xc(t),v.yc().addRemoveThirdFilterDetail(!1)})),v.ic(),v.ic()}2&t&&(v.Pb(1),v.Hc("options",v.Nc(2,H,v.Mc(1,q))))}function O(t,e){if(1&t){const t=v.kc();v.hc(0),v.jc(1,"span"),v.jc(2,"button",56),v.uc("click",(function(){v.Xc(t);const e=v.yc(),i=e.$implicit,c=e.index;return v.yc().crossClick(i,c)})),v.jc(3,"span",57),v.jd(4,"\xd7"),v.ic(),v.ic(),v.ic(),v.gc()}}function N(t,e){if(1&t&&(v.jc(0,"div"),v.jc(1,"div",54),v.jd(2),v.hd(3,O,5,0,"ng-container",55),v.ic(),v.ic()),2&t){const t=e.$implicit;v.Pb(2),v.md(" Meter: ",t.mtr," Weight: ",t.wt," "),v.Pb(1),v.Hc("ngIf",!t.isProductionPlanned)}}function U(t,e){if(1&t){const t=v.kc();v.jc(0,"button",58),v.uc("click",(function(){v.Xc(t);const e=v.yc(),i=v.Uc(16);return e.resetForm(i)})),v.jd(1," CANCEL "),v.ic()}}const $=function(){return["/pages/merge-batch/view"]};function T(t,e){1&t&&(v.jc(0,"button",59),v.jd(1," CANCEL "),v.ic()),2&t&&v.Hc("routerLink",v.Mc(1,$))}function X(t,e){if(1&t){const t=v.kc();v.jc(0,"button",60),v.uc("click",(function(){v.Xc(t);const e=v.yc(),i=v.Uc(16);return e.saveMergedBatch(i)})),v.jd(1," Save "),v.ic()}if(2&t){const t=v.yc();v.Hc("disabled",t.loading)}}function E(t,e){if(1&t){const t=v.kc();v.jc(0,"button",60),v.uc("click",(function(){v.Xc(t);const e=v.yc(),i=v.Uc(16);return e.updateMergedBatch(i)})),v.jd(1," Update "),v.ic()}if(2&t){const t=v.yc();v.Hc("disabled",t.loading)}}let _=(()=>{class t{constructor(t,e,i,c,n,a,r,s){this.toastr=t,this.partyService=e,this.qualityService=i,this.stockBatchService=c,this.mergeBatchService=n,this.commonService=a,this._route=r,this.route=s,this.filterDetails=[],this.qualityList=[],this.finalGrList=[],this.DROP_LIST_IDS=[],this.refreshCount=0,this.newBatchId="",this.loading=!1,this.showMergeBox=!1,this.disable=!1,this.destroy$=new l.a,this.filterDetails.push(this._clone(new u)),this.filterDetails.push(this._clone(new u))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){return Object(o.a)(this,void 0,void 0,(function*(){this.getUserId(),this.currentId&&(this.getCurrentMergeBatchData(),this.disable=!0),yield this.getAllParties();for(let t=1;t<=3;t++)this.addId(t)}))}getUserId(){this.user=this.commonService.getUser(),this.userHead=this.commonService.getUserHeadId(),this.currentId=this._route.snapshot.paramMap.get("id")}getCurrentMergeBatchData(){this.mergeBatchService.getMergeBatchById(this.currentId).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{if(t.success){this.currentMergeBatch=t.data;let e=this.currentMergeBatch.partyId.split(","),i=this.currentMergeBatch.qualityEntryId.split(","),c=this.currentMergeBatch.batchId.split(",");e.forEach((t,e)=>{this.filterDetails[e].partyId=Number(t),this.partySelected(t,e)}),i.forEach((t,e)=>{this.filterDetails[e].qualityId=Number(t),this.qualitySelected(t,e)}),c.forEach((t,e)=>{this.filterDetails[e].batchId=Number(t),this.batchSelected(t,e)}),this.showMergeBox=!0,this.finalGrList=this.currentMergeBatch.batchDataList}},t=>{})}_clone(t){return JSON.parse(JSON.stringify(t))}addId(t){this.DROP_LIST_IDS.push("cdk-drop-list-"+t)}getAllParties(){this.partyList=[],this.partyService.getAllPartyList(0,"all").pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success&&(this.partyList=t.data)})}partySelected(t,e){this.filterDetails[e].qualityList=[],this.filterDetails[e].qualityId=null,this.filterDetails[e].batchId=null,t&&this.qualityService.getQualityByParty(this.filterDetails[e].partyId).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success&&(this.filterDetails[e].qualityList=t.data.qualityDataList)}),this.refreshCount>10?this.refreshCount=0:this.refreshCount++}qualitySelected(t,e){this.filterDetails[e].batchList=[],this.filterDetails[e].batchId=null,t&&this.mergeBatchService.getBatchesByPartyQuality(this.filterDetails[e].qualityId,this.filterDetails[e].partyId).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success&&(this.filterDetails[e].batchList=t.data)}),this.refreshCount>10?this.refreshCount=0:this.refreshCount++}addRemoveThirdFilterDetail(t){t?this.filterDetails.push(this._clone(new u)):this.filterDetails.splice(this.filterDetails.length-1,1)}batchSelected(t,e){this.enableMergeBox(),this.filterDetails[e].grList=[],t?this.stockBatchService.getBatchGRById(this.filterDetails[e].batchId).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success&&(this.filterDetails[e].grList=t.data)}):this.filterDetails.forEach((t,e)=>{t.batchId&&this.batchSelected(t.batchId,e)}),this.refreshCount>10?this.refreshCount=0:this.refreshCount++}addAllGrInMergeBatch(t){this.filterDetails.forEach((e,i)=>{e.batchId==t&&(this.finalGrList=[...this.finalGrList,...e.grList],e.grList=[])})}drop(t){t.previousContainer===t.container?Object(h.d)(t.container.data,t.previousIndex,t.currentIndex):Object(h.e)(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex)}enableMergeBox(){let t=0;this.filterDetails.forEach(e=>{e.batchId&&t++}),this.showMergeBox=t>1}saveMergedBatch(t){if(this.loading=!0,this.finalGrList&&this.finalGrList.length){let e=0;this.filterDetails.forEach(t=>{t.batchId&&e++}),e>1?(this.currentId||this.stockBatchService.getBatchSequence(!0).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success&&(this.newBatchId=t.data.sequence)}),setTimeout(()=>{this.currentId?this.mergeBatchService.updateMergeBatch({mergeBatchId:this.currentMergeBatch.mergeBatchId,batchDataList:this.finalGrList}).pipe(Object(d.a)(this.destroy$)).subscribe(e=>{e.success&&(this.toastr.success(e.msg),this.loading=!1,this.showMergeBox=!1,this.resetForm(t)),this.loading=!1},t=>{this.loading=!1}):this.mergeBatchService.saveMergedBatch({mergeBatchId:this.newBatchId,batchDataList:this.finalGrList}).pipe(Object(d.a)(this.destroy$)).subscribe(e=>{e.success&&(this.toastr.success(e.msg),this.loading=!1,this.showMergeBox=!1,this.resetForm(t)),this.loading=!1},t=>{this.loading=!1})},1e3)):(this.toastr.error("Please select another batch to merge"),this.loading=!1)}else this.loading=!1}resetForm(t){this.finalGrList=[],t.reset(),this.filterDetails=[],this.filterDetails.push(this._clone(new u)),this.filterDetails.push(this._clone(new u)),this.showMergeBox=!1}crossClick(t,e){this.finalGrList.splice(e,1),this.filterDetails.forEach(e=>{e.batchId==t.batchId&&(e.grList=[...e.grList,t])})}updateMergedBatch(t){this.saveMergedBatch(t)}tableChange(t){"view table"===t&&this.route.navigate(["/pages/merge-batch/view"])}}return t.\u0275fac=function(e){return new(e||t)(v.dc(y.b),v.dc(p.a),v.dc(g.a),v.dc(b.a),v.dc(m.a),v.dc(f.a),v.dc(r.a),v.dc(r.c))},t.\u0275cmp=v.Xb({type:t,selectors:[["ngx-merge-batch"]],decls:39,vars:12,consts:[[1,"row"],[1,"col-md-12"],[1,"nb-style"],[1,"nb-header"],[1,"col-md-5","col-6","display-flex-start","max-width-device"],["placeholder","Select",1,"btn","btn-md",3,"change"],["value","view table"],[1,"col-md-6"],[1,"nb-text"],["mergeForm","ngForm"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"add-minus-party"],["class","width-100",4,"ngIf"],[1,"container"],[1,"example-container","pd-0-mr-15"],[1,"disply-flex"],[1,"batch-text"],["cdkDropList","",1,"example-list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["finalPart","cdkDropList"],[1,"col-md-12","col-12"],[4,"ngFor","ngForOf"],[1,"col-md-12","mobile-btn-center","text-btn-right"],[1,"mrtp-10"],["class","btn btn-primary btn-sm btn-design-cancel","type","button",3,"click",4,"ngIf"],["class","btn btn-primary btn-sm btn-design-cancel","type","button",3,"routerLink",4,"ngIf"],["type","button","class","btn btn-primary btn-sm btn-design-save button-base ripple",3,"disabled","click",4,"ngIf"],[1,"col-md-4"],[1,"form-group","party-in"],[1,"required"],["appendTo","body","placeholder","Select Party",3,"name","ngModel","disabled","ngModelChange","change"],["partyId1{{i}}","ngModel"],["disabled","true"],[1,"col-md-6","col-6"],[1,"text-left","txt-ov-elips"],[1,"text-right","txt-ov-elips"],[3,"value",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[3,"value"],[1,"form-group","col-md-12"],[1,"quality-in"],["appendTo","body","placeholder","Select Quality",3,"name","ngModel","disabled","ngModelChange","change"],["qualityId1{{i}}","ngModel"],[1,"batch-in"],["appendTo","body","placeholder","Select Batch",3,"name","ngModel","disabled","ngModelChange","change"],["batchId{{i}}","ngModel"],[1,"example-container","batch-merged-pd"],[1,"btn","btn-primary","btn-sm","btn-design-addAll","btn-position-addAll",3,"click"],[1,"merged-batch-indiviual"],["cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag",""],[1,"example-box"],[1,"width-100"],["icon","plus","status","primary",1,"icon-batch-white","status-primary",3,"options","click"],["icon","minus","status","primary",1,"icon-batch-white","status-primary",3,"options","click"],[1,"example-box","position-rel"],[4,"ngIf"],["aria-label","Close",1,"close","btn-foucs-none","pd-18",3,"click"],["aria-hidden","true",1,"close-icon"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-cancel",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-cancel",3,"routerLink"],["type","button",1,"btn","btn-primary","btn-sm","btn-design-save","button-base","ripple",3,"disabled","click"]],template:function(t,e){1&t&&(v.jc(0,"div",0),v.jc(1,"div",1),v.jc(2,"nb-card",2),v.jc(3,"nb-card-header",3),v.jc(4,"div",0),v.jc(5,"div",4),v.jc(6,"ng-select",5),v.uc("change",(function(t){return e.tableChange(t)})),v.jc(7,"ng-option",6),v.jd(8,"View Table"),v.ic(),v.ic(),v.ic(),v.jc(9,"div",7),v.jc(10,"h2",8),v.jd(11,"Merge Batch"),v.ic(),v.ic(),v.ic(),v.ic(),v.jc(12,"nb-card-body"),v.jc(13,"div",0),v.jc(14,"div",1),v.jc(15,"form",null,9),v.jc(17,"div",0),v.hd(18,w,18,7,"div",10),v.jc(19,"div",11),v.hd(20,F,2,4,"div",12),v.hd(21,A,2,4,"div",12),v.ic(),v.ic(),v.jc(22,"div",13),v.jc(23,"div",14),v.jc(24,"div",15),v.jc(25,"h2",16),v.jd(26,"Merged Batches"),v.ic(),v.ic(),v.jc(27,"div",17,18),v.uc("cdkDropListDropped",(function(t){return e.drop(t)})),v.jc(29,"div",0),v.jc(30,"div",19),v.hd(31,N,4,3,"div",20),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.jc(32,"div",0),v.jc(33,"div",21),v.jc(34,"div",22),v.hd(35,U,2,0,"button",23),v.hd(36,T,2,2,"button",24),v.hd(37,X,2,1,"button",25),v.hd(38,E,2,1,"button",25),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic(),v.ic()),2&t&&(v.Pb(18),v.Hc("ngForOf",e.filterDetails),v.Pb(2),v.Hc("ngIf",2==e.filterDetails.length),v.Pb(1),v.Hc("ngIf",3==e.filterDetails.length),v.Pb(2),v.ed("visibility",e.showMergeBox?"visible":"hidden"),v.Pb(4),v.Hc("cdkDropListData",e.finalGrList)("cdkDropListConnectedTo",e.DROP_LIST_IDS),v.Pb(4),v.Hc("ngForOf",e.finalGrList),v.Pb(4),v.Hc("ngIf",!e.currentId),v.Pb(1),v.Hc("ngIf",e.currentId),v.Pb(1),v.Hc("ngIf",!e.currentId),v.Pb(1),v.Hc("ngIf",e.currentId))},directives:[j.u,j.x,B.a,B.c,j.t,a.x,a.m,a.n,c.m,c.n,h.b,a.l,a.o,h.a,j.I,r.d],pipes:[I.a],styles:[".example-container[_ngcontent-%COMP%]{width:100%;padding:0 50px}.example-list[_ngcontent-%COMP%]{border:3px solid #a03636;min-height:60px;background:#fff;border-radius:0 0 20px 20px;overflow:hidden;display:block;border-top:0;padding:0 10px}.batch-2[_ngcontent-%COMP%]{margin:12px;text-align:center;padding:7px 15px;border:1px solid #5e5b5e;background:#06c;color:#fff;border-radius:20px;box-sizing:border-box;cursor:move;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.icon-batch-white[_ngcontent-%COMP%]{font-size:24px!important}nb-icon.status-primary[_ngcontent-%COMP%]{color:#fff!important}"]}),t})();var z=i("3jao"),G=i("qZsz"),W=i("dfbw"),R=i("kF6S"),Q=i("1kSV"),J=i("qC+V"),V=i("+lss");const Z=["searchfilter"],K=function(){return{type:"zoom"}},Y=function(t){return{animation:t}};function tt(t,e){if(1&t){const t=v.kc();v.hc(0),v.jc(1,"nb-icon",24),v.uc("click",(function(){v.Xc(t);const e=v.yc().row;return v.yc().deleteMergeBatch(e.mergeBatchId)})),v.ic(),v.gc()}if(2&t){const t=v.yc(2);v.Pb(1),v.Hc("options",v.Nc(3,Y,v.Mc(2,K)))("hidden",t.hiddenDelete)}}const et=function(t){return["/pages/merge-batch/edit",t]};function it(t,e){if(1&t&&(v.ec(0,"nb-icon",22),v.jd(1,"\xa0\xa0 "),v.hd(2,tt,2,5,"ng-container",23)),2&t){const t=e.row,i=v.yc();v.Hc("options",v.Nc(5,Y,v.Mc(4,K)))("routerLink",v.Nc(7,et,t.mergeBatchId))("hidden",i.hiddenEdit),v.Pb(2),v.Hc("ngIf",!t.isProductionPlanned)}}function ct(t,e){if(1&t){const t=v.kc();v.jd(0,"Mergeed Batch Id "),v.jc(1,"div",25),v.jc(2,"nb-icon",26),v.uc("click",(function(){return v.Xc(t),v.yc().onOpenFilter("mergeBatchId")})),v.ic(),v.ic()}if(2&t){v.yc();const t=v.Uc(32);v.Pb(2),v.Hc("nbPopover",t)}}function nt(t,e){if(1&t){const t=v.kc();v.jd(0,"Party Name "),v.jc(1,"div",25),v.jc(2,"nb-icon",26),v.uc("click",(function(){return v.Xc(t),v.yc().onOpenFilter("partyName")})),v.ic(),v.ic()}if(2&t){v.yc();const t=v.Uc(32);v.Pb(2),v.Hc("nbPopover",t)}}function at(t,e){if(1&t){const t=v.kc();v.jd(0,"Quality Name "),v.jc(1,"div",25),v.jc(2,"nb-icon",26),v.uc("click",(function(){return v.Xc(t),v.yc().onOpenFilter("qualityName")})),v.ic(),v.ic()}if(2&t){v.yc();const t=v.Uc(32);v.Pb(2),v.Hc("nbPopover",t)}}function rt(t,e){if(1&t){const t=v.kc();v.jd(0,"Batch Id "),v.jc(1,"div",25),v.jc(2,"nb-icon",26),v.uc("click",(function(){return v.Xc(t),v.yc().onOpenFilter("batchId")})),v.ic(),v.ic()}if(2&t){v.yc();const t=v.Uc(32);v.Pb(2),v.Hc("nbPopover",t)}}function st(t,e){if(1&t&&(v.jc(0,"option",27),v.jd(1),v.ic()),2&t){const t=e.$implicit;v.Hc("value",t),v.Pb(1),v.kd(t)}}function ot(t,e){if(1&t){const t=v.kc();v.hc(0),v.jc(1,"ng-select",39),v.uc("ngModelChange",(function(e){return v.Xc(t),v.yc(2).operatorSelected=e})),v.jc(2,"ng-option",40),v.jd(3,"Conatins"),v.ic(),v.jc(4,"ng-option",41),v.jd(5,"Equals"),v.ic(),v.jc(6,"ng-option",42),v.jd(7,"Not Equals"),v.ic(),v.jc(8,"ng-option",43),v.jd(9,"Starts With"),v.ic(),v.jc(10,"ng-option",44),v.jd(11,"Ends With"),v.ic(),v.ic(),v.gc()}if(2&t){const t=v.yc(2);v.Pb(1),v.Hc("ngModel",t.operatorSelected)}}function dt(t,e){if(1&t){const t=v.kc();v.hc(0),v.jc(1,"ng-select",39),v.uc("ngModelChange",(function(e){return v.Xc(t),v.yc(2).operatorSelected=e})),v.jc(2,"ng-option",45),v.jd(3,"Greater Than"),v.ic(),v.jc(4,"ng-option",46),v.jd(5,"Less Than"),v.ic(),v.jc(6,"ng-option",41),v.jd(7,"Equals"),v.ic(),v.jc(8,"ng-option",42),v.jd(9,"Not Equals"),v.ic(),v.ic(),v.gc()}if(2&t){const t=v.yc(2);v.Pb(1),v.Hc("ngModel",t.operatorSelected)}}function lt(t,e){if(1&t){const t=v.kc();v.jc(0,"div",28),v.jc(1,"div",29),v.jc(2,"div",30),v.jc(3,"span",31),v.jd(4,"Filter"),v.ic(),v.ic(),v.jc(5,"div",32),v.jc(6,"div",33),v.uc("click",(function(){return v.Xc(t),v.yc().closeFilterPopover()})),v.jc(7,"strong"),v.jd(8,"X"),v.ic(),v.ic(),v.ic(),v.ic(),v.jc(9,"div",34),v.jc(10,"div",35),v.hd(11,ot,12,1,"ng-container",23),v.hd(12,dt,10,1,"ng-container",23),v.ic(),v.jc(13,"div",35),v.jc(14,"input",36),v.uc("ngModelChange",(function(e){return v.Xc(t),v.yc().filterWord=e})),v.ic(),v.ic(),v.ic(),v.jc(15,"button",37),v.uc("click",(function(){return v.Xc(t),v.yc().onApplyFilter()})),v.jd(16,"Apply"),v.ic(),v.jc(17,"button",38),v.uc("click",(function(){return v.Xc(t),v.yc().closeFilterPopover()})),v.jd(18,"Close"),v.ic(),v.ic()}if(2&t){const t=v.yc();v.Pb(11),v.Hc("ngIf",t.stringFlag),v.Pb(1),v.Hc("ngIf",t.numberFlag),v.Pb(2),v.Hc("ngModel",t.filterWord)}}const ht=function(){return["/pages/merge-batch"]},pt=[{path:"",component:_,canActivate:[s.a],canLoad:[s.a],data:{PermissionName:["add"]}},{path:"view",component:(()=>{class t{constructor(t,e,i,c){this.toastr=t,this.mergeBatchService=e,this.modalService=i,this.mergeBatchGuard=c,this.mergeList=[],this.tableStyle="bootstrap",this.loading=!1,this.mergeListCopy=[],this.hiddenAdd=!0,this.hiddenEdit=!0,this.hiddenDelete=!0,this.destroy$=new l.a,this.numberFlag=!1,this.stringFlag=!1,this.pageSizes=[10,20,50,100],this.selectedPageSize=20,this.requestData=new W.a,this.filterWord="",this.selectedColumnForFilter="",this.operatorSelected=null,this.tableHeaders=["invoiceNo","partyName","batchList","totalMtr","finishMtr","netAmt","date"],this.searchStr="",this.searchANDCondition=!1}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.getAccess(),this.requestData.data=new z.a,this.requestData.getBy="all",this.getAllMergeBatch()}getAccess(){this.mergeBatchGuard.accessRights("add")&&(this.hiddenAdd=!1),this.mergeBatchGuard.accessRights("delete")&&(this.hiddenDelete=!1),this.mergeBatchGuard.accessRights("edit")&&(this.hiddenEdit=!1)}filter(t){const e=t.toString().toLowerCase().trim(),i=Object.keys(this.mergeListCopy[0]);this.mergeList=this.mergeListCopy.filter(t=>{for(let c=0;c<i.length;c++)if(t[i[c]]&&-1!==t[i[c]].toString().toLowerCase().indexOf(e)||!e)return!0})}getAllMergeBatch(){this.loading=!0,this.mergeBatchService.getAllMergeBatchV1(this.requestData).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{if(t.success){const e=t.data;this.mergeList=e.data,this.requestData.data.total=e.total,this.mergeListCopy=this.mergeList.map(t=>({batchId:t.batchId,mergeBatchId:t.mergeBatchId,partyName:t.partyName,qualityName:t.qualityName,totalMtr:t.totalMtr,totalWt:t.totalWt})),this.loading=!1}this.loading=!1},t=>{this.loading=!1})}deleteMergeBatch(t){this.modalService.open(R.a,{size:"sm"}).result.then(e=>{e&&this.mergeBatchService.deleteMergeBatch(t).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{t.success?(this.toastr.success(t.msg),this.getAllMergeBatch()):this.toastr.error(t.msg)},t=>{})})}setPage(t){this.requestData.data.pageIndex=t.offset,this.getAllMergeBatch()}pageSizeChanged(){this.requestData.data.pageSize=Number(this.selectedPageSize),this.getAllMergeBatch()}onOpenFilter(t){"invoiceNo"==t||"partyName"==t||"createdAt"==t?(this.stringFlag=!0,this.numberFlag=!1):(this.numberFlag=!0,this.stringFlag=!1);const e=this.requestData.data.parameters.findIndex(e=>e.field.find(e=>e==t));e>-1?(this.filterWord=this.requestData.data.parameters[e].value,this.operatorSelected=this.requestData.data.parameters[e].operator):(this.filterWord="",this.operatorSelected=null),this.selectedColumnForFilter=t,this.popover.show()}onApplyFilter(){this.popover.hide();const t=this.requestData.data.parameters.findIndex(t=>t.field.find(t=>t==this.selectedColumnForFilter));if(t>-1)this.requestData.data.parameters[t].operator=this.operatorSelected,this.requestData.data.parameters[t].value=this.filterWord;else{let t=new G.a;t.field=[this.selectedColumnForFilter],t.value=this.filterWord,t.operator=this.operatorSelected,this.requestData.data.parameters.push(t)}this.requestData.data.pageIndex=0,this.getAllMergeBatch()}onClear(t){let e;e=this.requestData.data.parameters.findIndex(t?e=>e.field.find(e=>e==t):t=>t.field.find(t=>t==this.selectedColumnForFilter)),e>-1&&(this.filterWord="",this.operatorSelected=null,this.requestData.data.parameters.splice(e,1),this.requestData.data.pageIndex=0,this.getAllMergeBatch())}closeFilterPopover(){this.popover.hide()}onClearFilter(){this.popover.hide(),this.requestData.data.parameters.length>0&&(this.requestData.data.parameters=[],this.getAllMergeBatch())}}return t.\u0275fac=function(e){return new(e||t)(v.dc(y.b),v.dc(m.a),v.dc(Q.e),v.dc(s.a))},t.\u0275cmp=v.Xb({type:t,selectors:[["ngx-view-merge-batch"]],viewQuery:function(t,e){var i;1&t&&(v.cd(Z,!0),v.nd(j.ab,!0)),2&t&&(v.Tc(i=v.vc())&&(e.filterTextBox=i.first),v.Tc(i=v.vc())&&(e.popover=i.first))},decls:33,vars:21,consts:[[3,"show"],[1,"nb-style"],[1,"nb-header"],[1,"row"],[1,"col-md-1","col-3","display-flex-start"],[1,"btn","btn-primary","btn-md","btn-design",3,"routerLink","disabled"],[1,"col-md-9","col-7"],[1,"nb-text"],[1,"col-md-6"],["type","text","placeholder","Search","aria-label","Search","aria-describedby","basic-addon1",1,"form-control",3,"keyup"],["let","","index","",1,"material","table-responsive",3,"rows","ngClass","headerHeight","footerHeight","externalPaging","count","offset","limit","selectionType","page"],["name","Action","sortable","false","prop","id",3,"maxWidth"],["ngx-datatable-cell-template",""],["name","Mergeed Batch Id","prop","mergeBatchId"],["ngx-datatable-header-template",""],["name","Party Name","prop","partyName"],["name","Quality Name","prop","qualityName"],["name","Batch Id","prop","batchId"],[1,"page-sizer","d-flex"],["name","pageSizer",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["templateRef",""],["icon","edit","status","primary",3,"options","routerLink","hidden"],[4,"ngIf"],["icon","trash","status","danger",3,"options","hidden","click"],[1,"filter-icon"],["icon","menu-outline","nbPopoverTrigger","noop",1,"nb-icon-filter",3,"nbPopover","click"],[3,"value"],["id","filterDiv",2,"padding","2px 14px","width","250px"],[1,"row",2,"background-color","#aa3634"],[1,"col-md-10"],[2,"color","white"],[1,"col-md-2",2,"margin-top","3px","color","white"],[2,"cursor","pointer","text-align","center",3,"click"],[1,"row",2,"margin-top","8px"],[1,"col-md-12","mb-1"],["type","text","placeholder","Filter...",1,"form-control",3,"ngModel","ngModelChange"],["nbButton","","status","primary",2,"margin-right","5px",3,"click"],["nbButton","","status","danger",3,"click"],["appendTo","body","placeholder","Select Filter",1,"popup-select",3,"ngModel","ngModelChange"],["value","LIKE"],["value","EQUALS"],["value","NOT_EQUALS"],["value","START_WITH"],["value","END_WITH"],["value","GREATER_THAN"],["value","LESS_THAN"]],template:function(t,e){1&t&&(v.ec(0,"ngx-loading",0),v.jc(1,"nb-card",1),v.jc(2,"nb-card-header",2),v.jc(3,"div",3),v.jc(4,"div",4),v.jc(5,"button",5),v.jd(6,"ADD"),v.ic(),v.ic(),v.jc(7,"div",6),v.jc(8,"h2",7),v.jd(9,"Merge-Batch"),v.ic(),v.ic(),v.ic(),v.ic(),v.jc(10,"nb-card-body"),v.jc(11,"div",3),v.jc(12,"div",8),v.jc(13,"input",9),v.uc("keyup",(function(t){return e.filter(t.target.value)})),v.ic(),v.ic(),v.ic(),v.jc(14,"ngx-datatable",10),v.uc("page",(function(t){return e.setPage(t)})),v.zc(15,"searchInTable"),v.jc(16,"ngx-datatable-column",11),v.hd(17,it,3,9,"ng-template",12),v.ic(),v.jc(18,"ngx-datatable-column",13),v.hd(19,ct,3,1,"ng-template",14),v.ic(),v.jc(20,"ngx-datatable-column",15),v.hd(21,nt,3,1,"ng-template",14),v.ic(),v.jc(22,"ngx-datatable-column",16),v.hd(23,at,3,1,"ng-template",14),v.ic(),v.jc(24,"ngx-datatable-column",17),v.hd(25,rt,3,1,"ng-template",14),v.ic(),v.ic(),v.jc(26,"div",18),v.jc(27,"span"),v.jd(28,"Page Size: "),v.ic(),v.jc(29,"select",19),v.uc("ngModelChange",(function(t){return e.selectedPageSize=t}))("change",(function(){return e.pageSizeChanged()})),v.hd(30,st,2,2,"option",20),v.ic(),v.ic(),v.ic(),v.ic(),v.hd(31,lt,19,3,"ng-template",null,21,v.id)),2&t&&(v.Hc("show",e.loading),v.Pb(5),v.Hc("routerLink",v.Mc(20,ht))("disabled",e.hiddenAdd),v.Pb(9),v.Hc("rows",v.Dc(15,15,e.mergeList,e.searchStr,e.requestData.data.isAnd,e.tableHeaders))("ngClass","bootstrap")("headerHeight",31)("footerHeight",40)("externalPaging",!0)("count",e.requestData.data.total)("offset",e.requestData.data.pageIndex)("limit",e.requestData.data.pageSize)("selectionType","checkbox"),v.Pb(2),v.Hc("maxWidth",90),v.Pb(13),v.Hc("ngModel",e.selectedPageSize),v.Pb(1),v.Hc("ngForOf",e.pageSizes))},directives:[J.a,j.u,j.x,r.d,j.t,n.e,c.l,n.b,n.a,n.c,a.u,a.l,a.o,c.m,j.I,c.n,j.ab,a.p,a.w,a.a,j.q,B.a,B.c],pipes:[V.a],styles:[""]}),t})(),canActivate:[s.a],canLoad:[s.a],data:{PermissionName:["view","view group","view all"]}},{path:"edit/:id",component:_,canActivate:[s.a],canLoad:[s.a],data:{PermissionName:["edit","edit group","edit all"]}}];let ut=(()=>{class t{}return t.\u0275mod=v.bc({type:t}),t.\u0275inj=v.ac({factory:function(e){return new(e||t)},providers:[s.a],imports:[[r.g.forChild(pt)],r.g]}),t})();var gt=i("vTDv"),bt=i("yzeJ");let mt=(()=>{class t{}return t.\u0275mod=v.bc({type:t}),t.\u0275inj=v.ac({factory:function(e){return new(e||t)},imports:[[c.c,bt.a,gt.a,h.c,ut,a.s,n.g]]}),t})()}}]);